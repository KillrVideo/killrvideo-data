{
  "video_id": "Li3KJi4kjAg",
  "title": "DS201.11 Snitch | Foundations of Apache Cassandra",
  "description": "#DataStaxAcademy #DS201\nDS201.11 SNITCH\nA snitch in Apache Cassandra reports a node's rack and data center, thus snitches determine the topology of a cluster. Learn more about snitches in this unit.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-11T01:00:39Z",
  "thumbnail": "https://i.ytimg.com/vi/Li3KJi4kjAg/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "datastax",
    "tutorial",
    "apache_cassandra"
  ],
  "url": "https://www.youtube.com/watch?v=Li3KJi4kjAg",
  "transcript": {
    "available": true,
    "language": "Chinese",
    "language_code": "zh",
    "is_generated": false,
    "text": "DS201.11: Snitch（机架感知） 是时候讨论Snitch（机架感知）了 如果你是一位哈利波特粉丝 你会下意识的想到魁地奇\n(魁地奇是《哈利波特》中虚构的空中球赛\n其中比赛时所用的球叫“金色飞贼” 其英文是Golden Snitch) 你现在可以先把这个忘了 Cassandra中的Snitch是用来报告\n节点的机架(Rack)和数据中心(Data Center)的信息的 Snitch决定了集群的拓扑结构 也就是节点所属的位置 你有很多种不同的Snitch可进行选择 你可以在cassandra.yaml文件中指定你想使用哪一种 这些是你可以使用的Snitch种类 左边是常规的Snitch 右边则是基于云的Snitch 最受欢迎的是GossipingPropertyFileSnitch 但让我们仔细看看他们中的每一个 因此你可以判断哪种更符合你的使用场景 SimpleSnitch是默认的选项 这就是它的代码 SimpleSnitch并没有任何华丽的东西 当你将节点设置为使用SimpleSnitch时\n它会将所有节点放入datacenter1和rack1 要记得 数据中心中的节点机架只是逻辑上的分配概念 你会经常想要将它和实际的物理设置进行对应 和SimpleSnitch将数据写死在文件中（即硬编码）的方式相比 PropertyFileSnitch则会从本地配置文件cassandra-topology.properties中\n获取节点的数据中心和机架信息 虽然这比SimpleSnitch更加灵活 但你必须要维护每一个节点上各自的配置文件 同时这些配置文件还必须得保持同步 GossipingPropertyFileSnitch则集合了前两种Snitch的优点 你只需要分别设置每个节点所属的数据中心和机架 接着Gossip就会帮你把这个信息传播到整个集群 这样你就不需要在集群中维持多份文件的同步了 你可以在cassandra-rackdc.properties文件中进行配置 配置的方式非常简单直白 dc（数据中心）和rack（机架） 如何给dc和rack命名完全取决于你 你会在本节的练习中看到这点 RackInferringSnitch则会尝试\n从节点的ip地址中推断其所属的数据中心和机架 除非你的ip地址能非常清楚明白地和你当前的硬件物理设施相对应 否则千万不要用RackInferringSnitch 因为虽然这种Snitch所带来的便利十分诱人 但它不如你自己分配数据中心和机架来得灵活 如果你的数据库在云上运行 你也许想知道基于云的Snitch种类 在这儿我们不会再谈任何相关的细节\n但你可以在文档中找到更多信息 Dynamic Snitch（动态机架感知）是Snitch的附送功能 它是一种基于Snitch的访问包装器(access wrapper)\n你可以在cassandra.yaml文件中对其进行配置 它负责监控集群的健康状态和当前性能 当一个节点需要和其他副本节点互动时 Dynamic Snitch会帮节点判断目前哪个副本节点性能最佳 这样我们就不会再向迟缓的节点发送更多请求 而是选择能以最佳状态处理请求的节点进行交互 更多的信息 请见幻灯片下方的博客文章链接 请确保集群中所有的节点都使用同一种的snitch 不然你的集群很快会进入一个信息不一致的状态 如果你发现你有必要改动当前使用的Snitch种类 你必须要重启集群中的每一个节点 当你集群重新上线时 你必须要在所有节点上运行Repair和Cleanup 是时候开始练习了\n让我们来一起检测一下你的Snitch相关知识",
    "segments": [
      {
        "start": 0.745,
        "duration": 5.638,
        "text": "DS201.11: Snitch（机架感知）"
      },
      {
        "start": 6.383,
        "duration": 3.037,
        "text": "是时候讨论Snitch（机架感知）了"
      },
      {
        "start": 9.42,
        "duration": 3.83,
        "text": "如果你是一位哈利波特粉丝 你会下意识的想到魁地奇\n(魁地奇是《哈利波特》中虚构的空中球赛\n其中比赛时所用的球叫“金色飞贼” 其英文是Golden Snitch)"
      },
      {
        "start": 13.25,
        "duration": 2.318,
        "text": "你现在可以先把这个忘了"
      },
      {
        "start": 15.568,
        "duration": 5.044,
        "text": "Cassandra中的Snitch是用来报告\n节点的机架(Rack)和数据中心(Data Center)的信息的"
      },
      {
        "start": 20.612,
        "duration": 5.96,
        "text": "Snitch决定了集群的拓扑结构 也就是节点所属的位置"
      },
      {
        "start": 26.572,
        "duration": 3.565,
        "text": "你有很多种不同的Snitch可进行选择"
      },
      {
        "start": 30.137,
        "duration": 4.471,
        "text": "你可以在cassandra.yaml文件中指定你想使用哪一种"
      },
      {
        "start": 34.608,
        "duration": 2.595,
        "text": "这些是你可以使用的Snitch种类"
      },
      {
        "start": 37.203,
        "duration": 4.958,
        "text": "左边是常规的Snitch 右边则是基于云的Snitch"
      },
      {
        "start": 42.161,
        "duration": 3.883,
        "text": "最受欢迎的是GossipingPropertyFileSnitch"
      },
      {
        "start": 46.044,
        "duration": 2.373,
        "text": "但让我们仔细看看他们中的每一个"
      },
      {
        "start": 48.417,
        "duration": 3.427,
        "text": "因此你可以判断哪种更符合你的使用场景"
      },
      {
        "start": 51.844,
        "duration": 2.987,
        "text": "SimpleSnitch是默认的选项"
      },
      {
        "start": 54.831,
        "duration": 2.169,
        "text": "这就是它的代码"
      },
      {
        "start": 57.0,
        "duration": 2.285,
        "text": "SimpleSnitch并没有任何华丽的东西"
      },
      {
        "start": 59.285,
        "duration": 7.883,
        "text": "当你将节点设置为使用SimpleSnitch时\n它会将所有节点放入datacenter1和rack1"
      },
      {
        "start": 67.522,
        "duration": 4.478,
        "text": "要记得 数据中心中的节点机架只是逻辑上的分配概念"
      },
      {
        "start": 72.0,
        "duration": 4.162,
        "text": "你会经常想要将它和实际的物理设置进行对应"
      },
      {
        "start": 76.162,
        "duration": 3.948,
        "text": "和SimpleSnitch将数据写死在文件中（即硬编码）的方式相比"
      },
      {
        "start": 80.11,
        "duration": 9.587,
        "text": "PropertyFileSnitch则会从本地配置文件cassandra-topology.properties中\n获取节点的数据中心和机架信息"
      },
      {
        "start": 89.697,
        "duration": 3.425,
        "text": "虽然这比SimpleSnitch更加灵活"
      },
      {
        "start": 93.122,
        "duration": 3.298,
        "text": "但你必须要维护每一个节点上各自的配置文件"
      },
      {
        "start": 96.42,
        "duration": 2.347,
        "text": "同时这些配置文件还必须得保持同步"
      },
      {
        "start": 98.767,
        "duration": 3.952,
        "text": "GossipingPropertyFileSnitch则集合了前两种Snitch的优点"
      },
      {
        "start": 102.719,
        "duration": 4.882,
        "text": "你只需要分别设置每个节点所属的数据中心和机架"
      },
      {
        "start": 107.601,
        "duration": 4.494,
        "text": "接着Gossip就会帮你把这个信息传播到整个集群"
      },
      {
        "start": 112.095,
        "duration": 4.368,
        "text": "这样你就不需要在集群中维持多份文件的同步了"
      },
      {
        "start": 116.463,
        "duration": 4.808,
        "text": "你可以在cassandra-rackdc.properties文件中进行配置"
      },
      {
        "start": 121.271,
        "duration": 1.938,
        "text": "配置的方式非常简单直白"
      },
      {
        "start": 123.209,
        "duration": 2.18,
        "text": "dc（数据中心）和rack（机架）"
      },
      {
        "start": 125.389,
        "duration": 3.219,
        "text": "如何给dc和rack命名完全取决于你"
      },
      {
        "start": 128.608,
        "duration": 3.342,
        "text": "你会在本节的练习中看到这点"
      },
      {
        "start": 131.95,
        "duration": 6.13,
        "text": "RackInferringSnitch则会尝试\n从节点的ip地址中推断其所属的数据中心和机架"
      },
      {
        "start": 138.08,
        "duration": 4.657,
        "text": "除非你的ip地址能非常清楚明白地和你当前的硬件物理设施相对应"
      },
      {
        "start": 142.737,
        "duration": 2.513,
        "text": "否则千万不要用RackInferringSnitch"
      },
      {
        "start": 145.25,
        "duration": 2.919,
        "text": "因为虽然这种Snitch所带来的便利十分诱人"
      },
      {
        "start": 148.169,
        "duration": 4.47,
        "text": "但它不如你自己分配数据中心和机架来得灵活"
      },
      {
        "start": 152.639,
        "duration": 1.764,
        "text": "如果你的数据库在云上运行"
      },
      {
        "start": 154.403,
        "duration": 2.77,
        "text": "你也许想知道基于云的Snitch种类"
      },
      {
        "start": 157.173,
        "duration": 5.598,
        "text": "在这儿我们不会再谈任何相关的细节\n但你可以在文档中找到更多信息"
      },
      {
        "start": 163.3,
        "duration": 2.569,
        "text": "Dynamic Snitch（动态机架感知）是Snitch的附送功能"
      },
      {
        "start": 165.869,
        "duration": 4.983,
        "text": "它是一种基于Snitch的访问包装器(access wrapper)\n你可以在cassandra.yaml文件中对其进行配置"
      },
      {
        "start": 170.852,
        "duration": 3.587,
        "text": "它负责监控集群的健康状态和当前性能"
      },
      {
        "start": 174.439,
        "duration": 3.58,
        "text": "当一个节点需要和其他副本节点互动时"
      },
      {
        "start": 178.019,
        "duration": 5.649,
        "text": "Dynamic Snitch会帮节点判断目前哪个副本节点性能最佳"
      },
      {
        "start": 183.668,
        "duration": 3.279,
        "text": "这样我们就不会再向迟缓的节点发送更多请求"
      },
      {
        "start": 186.947,
        "duration": 3.345,
        "text": "而是选择能以最佳状态处理请求的节点进行交互"
      },
      {
        "start": 190.292,
        "duration": 4.306,
        "text": "更多的信息 请见幻灯片下方的博客文章链接"
      },
      {
        "start": 194.598,
        "duration": 4.277,
        "text": "请确保集群中所有的节点都使用同一种的snitch"
      },
      {
        "start": 198.875,
        "duration": 3.653,
        "text": "不然你的集群很快会进入一个信息不一致的状态"
      },
      {
        "start": 202.528,
        "duration": 3.655,
        "text": "如果你发现你有必要改动当前使用的Snitch种类"
      },
      {
        "start": 206.183,
        "duration": 2.874,
        "text": "你必须要重启集群中的每一个节点"
      },
      {
        "start": 209.057,
        "duration": 5.485,
        "text": "当你集群重新上线时 你必须要在所有节点上运行Repair和Cleanup"
      },
      {
        "start": 214.542,
        "duration": 4.936,
        "text": "是时候开始练习了\n让我们来一起检测一下你的Snitch相关知识"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-16T01:59:42.968946+00:00"
}