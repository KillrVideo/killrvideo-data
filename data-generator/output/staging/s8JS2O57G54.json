{
  "video_id": "s8JS2O57G54",
  "title": "DS320.11 Connecting Spark: Processing Cassandra Data | DataStax Enterprise Analytics",
  "description": "#DataStaxAcademy #DS320\nDS320.11 Connecting Spark: Processing Cassandra Data\nIn this course, you will learn how to effectively and efficiently solve analytical problems with Apache Spark™, Apache Cassandra™, and DataStax Enterprise. You will learn about the Spark API, Spark-Cassandra Connector, Spark SQL, Spark Streaming, and crucial performance optimization techniques.  You will also learn the basics of the productive and robust Scala programming language for data analysis and processing in Apache Spark™.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-16T00:26:50Z",
  "thumbnail": "https://i.ytimg.com/vi/s8JS2O57G54/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "tutorial",
    "apache_cassandra",
    "performance",
    "datastax"
  ],
  "url": "https://www.youtube.com/watch?v=s8JS2O57G54",
  "transcript": {
    "available": true,
    "language": "English (auto-generated)",
    "language_code": "en",
    "is_generated": true,
    "text": "[Music] next let's try to do something with that data that we get back we've created an rdd from a cassandra query and that rdd has cassandra row records in it they're objects of this type cassandra row let's see what we might do with that let's peel back the onion a little bit and check out that api our challenge here has two parts to it first i want to find all of the movies with the word pirate in their titles second i want to find all of the movies with genre adventure and a rating of 7.5 or higher now we are constraining this to the johnny depp universe of discourse so that is kind of a precondition that's the rdd that we're dealing with to start but those are the two things i want to do with that rdd also we've got specific requirements for how to format the output i don't just want to tostring the cassandra row object and take what i get i want to do a little bit of formatting myself to do this we have to know a little bit more about the cassandra row api let's take a look now we're going to be converting cassandra rows and cassandra columns that's actual data in a cassandra row into native scala types to do that we have to take a look at the mapping of cassandra data types into scala data types this slide gives you the key it's a pretty tall slide i'll have to scroll a little bit because there's a lot of data types to look at but text maps to string bigint to long counter is a long a double is mysteriously a double so not all of these are all that crazy int is an int time uuid maps onto a java util uuid so sometimes the jvm abstraction or the jdk abstraction sort of leaks up into the api here but really none of these is all that amazing or all that confusing it's a pretty straightforward mapping now let's let's put these to use now the first method we want to learn on cassandra row is the getter this is kind of an all-purpose workhorse this lets us grab a particular column by name and pull it out according to its data type and deal with that thing pull it into a vowel in scala and do things with it so taking a look at the definition here we have the get type method and type there is going to be the actual name of a data type as you see like string or a set of ints or a long or something like that and a column is a string that is the cassandra column name that we're fetching alternatively we could use the second syntax which is just the get method but specifying the return type of the method in square brackets so i could say get string and then the column type i'm always calling the method get but i'm specifying the return type in brackets the bummer here is that if the column doesn't exist you'll get a null pointer exception and nobody really likes those so we've got a slightly improved version of the api if that might be the case that's get type option so i could say get string option and title would be the column name or get float option rating and that will wrap the return value in an option object which lets me use that nice api and call like is defined and get and get or else and do all the things i can do with option rather than suffering that null pointer exception the second version of that which is similar to the the second version of the get syntax i'm just explicitly wrapping the type in options so i would say get option string using that second syntax if i preferred uh both of those do the same thing so with just that little bit of information that gives us enough to be able to answer our challenge remember we wanted to see all the movies with the word pirate in their title and to do that let's take a look at some code that was that was our first challenge we are going to operate on the movies rdd you see there on line one of the of the solution that's an rdd that we created to start with and we're going to filter it we're going to filter it and for each row we're going to get the title as a string and lowercase that and see if it contains the word pirate in lowercase that's filtering all of the johnny depp movies to to create a new rdd containing only those films that have the word pirate in them on the second line we map that and really all map is doing there is converting it into the string of the format that we said we wanted to have we take a row and then we pull out the title the release year the rating which we did a nice get or else call you see there on that fourth line to deal with with unrated movies then we take that mapped collection collect it and for reach it passing in print line and we get that nice output you see at the bottom that is our properly formatted report which is all of the movies by johnny depp with the word pirate in the title and problem number two was to get all of the movies that had the genre adventure among whatever other genres they might have they at least had to have that as one of their genres and a rating of 7.5 or higher we do the same kind of thing with filter and map now we have a slightly more complex filter predicate this time let's have a look at the code here we're pulling a row out and the first thing i want to do is i want to get the set of genres now that's a set of strings so i'm going to say on that first line does that set contain adventure as one of the strings and is the rating defined and is the rating greater than 7.5 so an unrated film or a rating below 7.5 those will not make the cut those are not going to be in the rdd returned by that filter transformation that filter transformation then gets mapped on the fourth line and again the map is just formatting the string it's pulling out those three columns that we care about concatenating them into a string returning it which we then collect and four each and print and we get a grand total of one film only one adventure film rated graded in 7.5 and that is pirates of the caribbean curse of the black pearl incredibly two thousand three",
    "segments": [
      {
        "start": 0.09,
        "duration": 7.43,
        "text": "[Music]"
      },
      {
        "start": 7.04,
        "duration": 2.32,
        "text": "next"
      },
      {
        "start": 7.52,
        "duration": 3.039,
        "text": "let's try to do something with that data"
      },
      {
        "start": 9.36,
        "duration": 4.0,
        "text": "that we get back"
      },
      {
        "start": 10.559,
        "duration": 3.361,
        "text": "we've created an rdd from a cassandra"
      },
      {
        "start": 13.36,
        "duration": 3.52,
        "text": "query"
      },
      {
        "start": 13.92,
        "duration": 4.32,
        "text": "and that rdd has cassandra row records"
      },
      {
        "start": 16.88,
        "duration": 2.479,
        "text": "in it they're objects of this type"
      },
      {
        "start": 18.24,
        "duration": 3.28,
        "text": "cassandra row"
      },
      {
        "start": 19.359,
        "duration": 4.08,
        "text": "let's see what we might do with that"
      },
      {
        "start": 21.52,
        "duration": 4.079,
        "text": "let's peel back the onion a little bit"
      },
      {
        "start": 23.439,
        "duration": 4.08,
        "text": "and check out that api our challenge"
      },
      {
        "start": 25.599,
        "duration": 3.76,
        "text": "here has two parts to it"
      },
      {
        "start": 27.519,
        "duration": 3.121,
        "text": "first i want to find all of the movies"
      },
      {
        "start": 29.359,
        "duration": 3.441,
        "text": "with the word pirate"
      },
      {
        "start": 30.64,
        "duration": 3.68,
        "text": "in their titles second i want to find"
      },
      {
        "start": 32.8,
        "duration": 5.279,
        "text": "all of the movies with genre"
      },
      {
        "start": 34.32,
        "duration": 5.68,
        "text": "adventure and a rating of 7.5 or higher"
      },
      {
        "start": 38.079,
        "duration": 3.921,
        "text": "now we are constraining this to the"
      },
      {
        "start": 40.0,
        "duration": 3.84,
        "text": "johnny depp universe of discourse"
      },
      {
        "start": 42.0,
        "duration": 3.76,
        "text": "so that is kind of a precondition that's"
      },
      {
        "start": 43.84,
        "duration": 3.6,
        "text": "the rdd that we're dealing with to start"
      },
      {
        "start": 45.76,
        "duration": 3.92,
        "text": "but those are the two things i want to"
      },
      {
        "start": 47.44,
        "duration": 4.0,
        "text": "do with that rdd"
      },
      {
        "start": 49.68,
        "duration": 3.199,
        "text": "also we've got specific requirements for"
      },
      {
        "start": 51.44,
        "duration": 3.36,
        "text": "how to format the output"
      },
      {
        "start": 52.879,
        "duration": 4.081,
        "text": "i don't just want to tostring the"
      },
      {
        "start": 54.8,
        "duration": 3.68,
        "text": "cassandra row object and take what i get"
      },
      {
        "start": 56.96,
        "duration": 3.36,
        "text": "i want to do a little bit of formatting"
      },
      {
        "start": 58.48,
        "duration": 3.68,
        "text": "myself to do this we have to know a"
      },
      {
        "start": 60.32,
        "duration": 4.0,
        "text": "little bit more about the cassandra row"
      },
      {
        "start": 62.16,
        "duration": 3.2,
        "text": "api let's take a look now we're going to"
      },
      {
        "start": 64.32,
        "duration": 3.6,
        "text": "be converting"
      },
      {
        "start": 65.36,
        "duration": 4.799,
        "text": "cassandra rows and cassandra columns"
      },
      {
        "start": 67.92,
        "duration": 5.44,
        "text": "that's actual data in a cassandra row"
      },
      {
        "start": 70.159,
        "duration": 4.481,
        "text": "into native scala types to do that we"
      },
      {
        "start": 73.36,
        "duration": 2.799,
        "text": "have to take a look at the mapping of"
      },
      {
        "start": 74.64,
        "duration": 4.64,
        "text": "cassandra data types"
      },
      {
        "start": 76.159,
        "duration": 4.561,
        "text": "into scala data types this slide"
      },
      {
        "start": 79.28,
        "duration": 3.12,
        "text": "gives you the key it's a pretty tall"
      },
      {
        "start": 80.72,
        "duration": 2.96,
        "text": "slide i'll have to scroll a little bit"
      },
      {
        "start": 82.4,
        "duration": 3.92,
        "text": "because there's a lot of data types to"
      },
      {
        "start": 83.68,
        "duration": 5.759,
        "text": "look at but text maps to string"
      },
      {
        "start": 86.32,
        "duration": 6.32,
        "text": "bigint to long counter is a long"
      },
      {
        "start": 89.439,
        "duration": 4.561,
        "text": "a double is mysteriously a double so not"
      },
      {
        "start": 92.64,
        "duration": 4.32,
        "text": "all of these are all that crazy"
      },
      {
        "start": 94.0,
        "duration": 4.4,
        "text": "int is an int time uuid maps onto a java"
      },
      {
        "start": 96.96,
        "duration": 3.76,
        "text": "util uuid"
      },
      {
        "start": 98.4,
        "duration": 4.24,
        "text": "so sometimes the jvm abstraction or the"
      },
      {
        "start": 100.72,
        "duration": 3.84,
        "text": "jdk abstraction sort of leaks up"
      },
      {
        "start": 102.64,
        "duration": 3.519,
        "text": "into the api here but really none of"
      },
      {
        "start": 104.56,
        "duration": 3.199,
        "text": "these is all that amazing or"
      },
      {
        "start": 106.159,
        "duration": 3.041,
        "text": "all that confusing it's a pretty"
      },
      {
        "start": 107.759,
        "duration": 2.32,
        "text": "straightforward mapping now let's let's"
      },
      {
        "start": 109.2,
        "duration": 2.48,
        "text": "put these to use"
      },
      {
        "start": 110.079,
        "duration": 3.121,
        "text": "now the first method we want to learn on"
      },
      {
        "start": 111.68,
        "duration": 2.96,
        "text": "cassandra row is"
      },
      {
        "start": 113.2,
        "duration": 3.599,
        "text": "the getter this is kind of an"
      },
      {
        "start": 114.64,
        "duration": 4.079,
        "text": "all-purpose workhorse this lets us grab"
      },
      {
        "start": 116.799,
        "duration": 3.68,
        "text": "a particular column by name"
      },
      {
        "start": 118.719,
        "duration": 3.921,
        "text": "and pull it out according to its data"
      },
      {
        "start": 120.479,
        "duration": 4.401,
        "text": "type and deal with that thing"
      },
      {
        "start": 122.64,
        "duration": 3.119,
        "text": "pull it into a vowel in scala and do"
      },
      {
        "start": 124.88,
        "duration": 3.84,
        "text": "things with it"
      },
      {
        "start": 125.759,
        "duration": 3.761,
        "text": "so taking a look at the definition here"
      },
      {
        "start": 128.72,
        "duration": 3.28,
        "text": "we have the get"
      },
      {
        "start": 129.52,
        "duration": 4.079,
        "text": "type method and type there is going to"
      },
      {
        "start": 132.0,
        "duration": 2.8,
        "text": "be the actual name of a data type as you"
      },
      {
        "start": 133.599,
        "duration": 5.441,
        "text": "see like string"
      },
      {
        "start": 134.8,
        "duration": 5.04,
        "text": "or a set of ints or a long or something"
      },
      {
        "start": 139.04,
        "duration": 4.0,
        "text": "like that"
      },
      {
        "start": 139.84,
        "duration": 4.479,
        "text": "and a column is a string that is the"
      },
      {
        "start": 143.04,
        "duration": 3.6,
        "text": "cassandra column name"
      },
      {
        "start": 144.319,
        "duration": 4.0,
        "text": "that we're fetching alternatively we"
      },
      {
        "start": 146.64,
        "duration": 4.0,
        "text": "could use the second syntax which is"
      },
      {
        "start": 148.319,
        "duration": 4.321,
        "text": "just the get method but specifying"
      },
      {
        "start": 150.64,
        "duration": 3.12,
        "text": "the return type of the method in square"
      },
      {
        "start": 152.64,
        "duration": 4.0,
        "text": "brackets so i could say"
      },
      {
        "start": 153.76,
        "duration": 4.32,
        "text": "get string and then the column type i'm"
      },
      {
        "start": 156.64,
        "duration": 4.239,
        "text": "always calling the method get"
      },
      {
        "start": 158.08,
        "duration": 3.519,
        "text": "but i'm specifying the return type in"
      },
      {
        "start": 160.879,
        "duration": 2.321,
        "text": "brackets"
      },
      {
        "start": 161.599,
        "duration": 3.601,
        "text": "the bummer here is that if the column"
      },
      {
        "start": 163.2,
        "duration": 4.16,
        "text": "doesn't exist you'll get a null pointer"
      },
      {
        "start": 165.2,
        "duration": 3.84,
        "text": "exception and nobody really likes those"
      },
      {
        "start": 167.36,
        "duration": 3.519,
        "text": "so we've got a slightly improved version"
      },
      {
        "start": 169.04,
        "duration": 4.32,
        "text": "of the api if that might be the case"
      },
      {
        "start": 170.879,
        "duration": 3.44,
        "text": "that's get type option so i could say"
      },
      {
        "start": 173.36,
        "duration": 3.12,
        "text": "get string"
      },
      {
        "start": 174.319,
        "duration": 3.441,
        "text": "option and title would be the column"
      },
      {
        "start": 176.48,
        "duration": 4.64,
        "text": "name or get"
      },
      {
        "start": 177.76,
        "duration": 6.479,
        "text": "float option rating and that will wrap"
      },
      {
        "start": 181.12,
        "duration": 5.28,
        "text": "the return value in an option object"
      },
      {
        "start": 184.239,
        "duration": 4.881,
        "text": "which lets me use that nice api and call"
      },
      {
        "start": 186.4,
        "duration": 4.0,
        "text": "like is defined and get and get or else"
      },
      {
        "start": 189.12,
        "duration": 3.44,
        "text": "and do all the things i can do with"
      },
      {
        "start": 190.4,
        "duration": 3.759,
        "text": "option rather than suffering that"
      },
      {
        "start": 192.56,
        "duration": 3.52,
        "text": "null pointer exception the second"
      },
      {
        "start": 194.159,
        "duration": 3.521,
        "text": "version of that which is"
      },
      {
        "start": 196.08,
        "duration": 4.0,
        "text": "similar to the the second version of the"
      },
      {
        "start": 197.68,
        "duration": 3.279,
        "text": "get syntax i'm just explicitly wrapping"
      },
      {
        "start": 200.08,
        "duration": 3.36,
        "text": "the type"
      },
      {
        "start": 200.959,
        "duration": 3.041,
        "text": "in options so i would say get option"
      },
      {
        "start": 203.44,
        "duration": 3.2,
        "text": "string"
      },
      {
        "start": 204.0,
        "duration": 4.08,
        "text": "using that second syntax if i preferred"
      },
      {
        "start": 206.64,
        "duration": 3.04,
        "text": "uh both of those do"
      },
      {
        "start": 208.08,
        "duration": 3.28,
        "text": "the same thing so with just that little"
      },
      {
        "start": 209.68,
        "duration": 3.119,
        "text": "bit of information that gives us enough"
      },
      {
        "start": 211.36,
        "duration": 2.72,
        "text": "to be able to answer our challenge"
      },
      {
        "start": 212.799,
        "duration": 2.8,
        "text": "remember we wanted to see all the movies"
      },
      {
        "start": 214.08,
        "duration": 3.6,
        "text": "with the word pirate in their title"
      },
      {
        "start": 215.599,
        "duration": 3.28,
        "text": "and to do that let's take a look at some"
      },
      {
        "start": 217.68,
        "duration": 2.559,
        "text": "code that was that was our first"
      },
      {
        "start": 218.879,
        "duration": 3.681,
        "text": "challenge we are going to"
      },
      {
        "start": 220.239,
        "duration": 3.28,
        "text": "operate on the movies rdd you see there"
      },
      {
        "start": 222.56,
        "duration": 2.48,
        "text": "on line one of the"
      },
      {
        "start": 223.519,
        "duration": 3.041,
        "text": "of the solution that's an rdd that we"
      },
      {
        "start": 225.04,
        "duration": 2.88,
        "text": "created to start with"
      },
      {
        "start": 226.56,
        "duration": 3.36,
        "text": "and we're going to filter it we're going"
      },
      {
        "start": 227.92,
        "duration": 4.8,
        "text": "to filter it and for each row"
      },
      {
        "start": 229.92,
        "duration": 3.28,
        "text": "we're going to get the title as a string"
      },
      {
        "start": 232.72,
        "duration": 2.799,
        "text": "and"
      },
      {
        "start": 233.2,
        "duration": 3.039,
        "text": "lowercase that and see if it contains"
      },
      {
        "start": 235.519,
        "duration": 4.161,
        "text": "the word"
      },
      {
        "start": 236.239,
        "duration": 6.481,
        "text": "pirate in lowercase that's filtering all"
      },
      {
        "start": 239.68,
        "duration": 5.119,
        "text": "of the johnny depp movies to to create a"
      },
      {
        "start": 242.72,
        "duration": 3.84,
        "text": "new rdd containing only those films"
      },
      {
        "start": 244.799,
        "duration": 3.44,
        "text": "that have the word pirate in them on the"
      },
      {
        "start": 246.56,
        "duration": 4.08,
        "text": "second line we map"
      },
      {
        "start": 248.239,
        "duration": 4.241,
        "text": "that and really all map is doing there"
      },
      {
        "start": 250.64,
        "duration": 4.0,
        "text": "is converting it into the string"
      },
      {
        "start": 252.48,
        "duration": 3.759,
        "text": "of the format that we said we wanted to"
      },
      {
        "start": 254.64,
        "duration": 4.159,
        "text": "have we take a row"
      },
      {
        "start": 256.239,
        "duration": 4.24,
        "text": "and then we pull out the title the"
      },
      {
        "start": 258.799,
        "duration": 3.761,
        "text": "release year the rating"
      },
      {
        "start": 260.479,
        "duration": 4.241,
        "text": "which we did a nice get or else call you"
      },
      {
        "start": 262.56,
        "duration": 5.12,
        "text": "see there on that fourth line"
      },
      {
        "start": 264.72,
        "duration": 4.32,
        "text": "to deal with with unrated movies then we"
      },
      {
        "start": 267.68,
        "duration": 4.0,
        "text": "take that mapped collection"
      },
      {
        "start": 269.04,
        "duration": 3.28,
        "text": "collect it and for reach it passing in"
      },
      {
        "start": 271.68,
        "duration": 2.16,
        "text": "print line"
      },
      {
        "start": 272.32,
        "duration": 3.76,
        "text": "and we get that nice output you see at"
      },
      {
        "start": 273.84,
        "duration": 3.52,
        "text": "the bottom that is our properly"
      },
      {
        "start": 276.08,
        "duration": 2.96,
        "text": "formatted report"
      },
      {
        "start": 277.36,
        "duration": 3.119,
        "text": "which is all of the movies by johnny"
      },
      {
        "start": 279.04,
        "duration": 3.76,
        "text": "depp with the word pirate"
      },
      {
        "start": 280.479,
        "duration": 3.841,
        "text": "in the title and problem number two was"
      },
      {
        "start": 282.8,
        "duration": 3.839,
        "text": "to get all of the movies"
      },
      {
        "start": 284.32,
        "duration": 3.599,
        "text": "that had the genre adventure among"
      },
      {
        "start": 286.639,
        "duration": 2.721,
        "text": "whatever other genres they might have"
      },
      {
        "start": 287.919,
        "duration": 2.321,
        "text": "they at least had to have that as one of"
      },
      {
        "start": 289.36,
        "duration": 3.76,
        "text": "their genres"
      },
      {
        "start": 290.24,
        "duration": 4.72,
        "text": "and a rating of 7.5 or higher we do the"
      },
      {
        "start": 293.12,
        "duration": 3.44,
        "text": "same kind of thing with filter"
      },
      {
        "start": 294.96,
        "duration": 3.28,
        "text": "and map now we have a slightly more"
      },
      {
        "start": 296.56,
        "duration": 3.44,
        "text": "complex filter predicate this time"
      },
      {
        "start": 298.24,
        "duration": 3.2,
        "text": "let's have a look at the code here we're"
      },
      {
        "start": 300.0,
        "duration": 3.039,
        "text": "pulling a row out"
      },
      {
        "start": 301.44,
        "duration": 3.68,
        "text": "and the first thing i want to do is i"
      },
      {
        "start": 303.039,
        "duration": 3.361,
        "text": "want to get the set of genres now that's"
      },
      {
        "start": 305.12,
        "duration": 3.04,
        "text": "a set of strings"
      },
      {
        "start": 306.4,
        "duration": 3.2,
        "text": "so i'm going to say on that first line"
      },
      {
        "start": 308.16,
        "duration": 4.56,
        "text": "does that set contain"
      },
      {
        "start": 309.6,
        "duration": 6.48,
        "text": "adventure as one of the strings and"
      },
      {
        "start": 312.72,
        "duration": 4.72,
        "text": "is the rating defined and is the rating"
      },
      {
        "start": 316.08,
        "duration": 5.04,
        "text": "greater than 7.5"
      },
      {
        "start": 317.44,
        "duration": 5.52,
        "text": "so an unrated film or a rating below 7.5"
      },
      {
        "start": 321.12,
        "duration": 4.16,
        "text": "those will not make the cut those are"
      },
      {
        "start": 322.96,
        "duration": 4.239,
        "text": "not going to be in the rdd returned"
      },
      {
        "start": 325.28,
        "duration": 3.52,
        "text": "by that filter transformation that"
      },
      {
        "start": 327.199,
        "duration": 3.921,
        "text": "filter transformation then"
      },
      {
        "start": 328.8,
        "duration": 3.36,
        "text": "gets mapped on the fourth line and again"
      },
      {
        "start": 331.12,
        "duration": 3.04,
        "text": "the map is"
      },
      {
        "start": 332.16,
        "duration": 3.12,
        "text": "just formatting the string it's pulling"
      },
      {
        "start": 334.16,
        "duration": 3.12,
        "text": "out those three"
      },
      {
        "start": 335.28,
        "duration": 3.199,
        "text": "columns that we care about concatenating"
      },
      {
        "start": 337.28,
        "duration": 3.28,
        "text": "them into a string"
      },
      {
        "start": 338.479,
        "duration": 3.121,
        "text": "returning it which we then collect and"
      },
      {
        "start": 340.56,
        "duration": 3.199,
        "text": "four each and print"
      },
      {
        "start": 341.6,
        "duration": 3.92,
        "text": "and we get a grand total of one film"
      },
      {
        "start": 343.759,
        "duration": 2.961,
        "text": "only one adventure film rated graded in"
      },
      {
        "start": 345.52,
        "duration": 3.28,
        "text": "7.5"
      },
      {
        "start": 346.72,
        "duration": 4.0,
        "text": "and that is pirates of the caribbean"
      },
      {
        "start": 348.8,
        "duration": 11.92,
        "text": "curse of the black pearl"
      },
      {
        "start": 350.72,
        "duration": 10.0,
        "text": "incredibly two thousand three"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-15T23:47:37.527189+00:00"
}