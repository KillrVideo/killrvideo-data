{
  "video_id": "oRtGqhKXw1Y",
  "title": "DS332.05 Using Spark GraphFrame API with DSE GraphFrames | DataStax Enterprise 6 Graph Analytics",
  "description": "#DataStaxAcademy #DS332\nDS332.05 Using Spark GraphFrame API with DSE GraphFrames\nIn this unit, we will introduce some methods of the original GraphFrame API from Spark. We will work on the same examples that we also used in our presentation called \"Using Gremlin with DSE GraphFrames\" so that you can easily compare Gremlin and GraphFrame APIs.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-16T00:39:11Z",
  "thumbnail": "https://i.ytimg.com/vi/oRtGqhKXw1Y/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "tutorial",
    "apache_cassandra",
    "dse",
    "datastax"
  ],
  "url": "https://www.youtube.com/watch?v=oRtGqhKXw1Y",
  "transcript": {
    "available": true,
    "language": "English (auto-generated)",
    "language_code": "en",
    "is_generated": true,
    "text": "[Music] hi i am artem chubatko and this is using sparkgraph frame api with the ac graph frames as you may have already noticed there are the ac graph frames and there are spar graph frames are they related and how dc graph frame is an extension of graph frame it uses graph frame compatible data format and can be converted to graph frame implicitly or using meta gf in this presentation we will introduce some methods of the original graph frame api from spark we will work on the same examples that we also used in our presentation called using gremlin with dac graph frames so that you can easily compare gremlin and graph frame apis i personally prefer using gremlin but it is always good to have options these are the main categories of methods available in graph frame api namely motif finding graph topology graph structure graph algaes and graph persistence it will require a lot of time to learn about all of these methods so we will only focus on the most interesting one for us the method called find you can always find more information about the other methods in the spark documentation motif fighting is an interesting way to express graph queries using graph pattern matching this is similar to the clarity of gremlin traversals but the syntax is of course quite different and it does rely heavily on data frame api as well so the general strategy is to first create a dac graph frame for a particular graph that exists in dsc graph we call meta dec graph for killer video on the spark session object second we call method find and pass it a graph pattern that needs to be matched against our killer video graph next we augment motif finding with data frame api methods like filter and select finally we use a method that can trigger computation in spark such as data frames show in this example here are some rules about defining graph patterns a unit pattern is simply a directed edge with two end points all three components can be given arbitrary names such as a e and b in this example denoting that the pattern must match an h e from vertex a to vertex b multiple unit patterns can be combined into a larger pattern using semicolons which serve as conjunction operators in this example we have two edges from a to b to c if different patterns components share the same name it means that they should match the same graph elements such as b is used as an endpoint in one edge and also an end point in the other edge b must match a vertex that has an incoming and outgoing edges accordingly to the pattern vertex and edge names become column names in the resulting data frame also vertex and age names can be emitted if they are not needed to be in the resulting data frame finally an edge can be negated to indicate that the edge should not be present in the graph this is done using an exclamation mark in front of a unit pattern in this example we find edges from a to b such that there exists no edge from b to a this simple motif finding example uses a unit pattern to match all edges in our graph and returns a data frame with three columns we show the first five found edges likely this is not the most useful query you can think of to make things more interesting we need a way to restrict vertex and edge labels as well as property values this can be done with data frame api here is an incomplete list of data frame methods that you may find to be useful even if you are not very familiar with spark data frames the names of these matters are descriptive enough to infer their purpose we will see some of them used in the following examples furthermore there are many predefined functions that can help you define even more complex graph queries you can sort things do mathematical calculation compute aggregates extract substrings work with states and so forth again this is an incomplete list and you can read this part recommendation for more details now we are ready to do some damage this is a simple query that finds robert deniers movies from 1970s we match edges with pattern movie e person and further require person's name to be robert deniro h label to be actor movie year to be greater than or equal to 1970 and less than 1980. we select title and year failures of such movies and output them using dataframes method show the result contains three movies next we find rating distribution for over the nearest movies and all the results by rating our graph pattern consists of two unit patterns user rated movie and movie actor person a person name must be over the nearer and two edges must have labels rated and actor since we're only interested in ratings we select the rating property values group them by rating and count how many values we have per group finally we rename column count 1 to simply count order by the rating column and show the results now we can go a bit further let's save the result of our analysis of robert denier's movie ratings into a cassandra table we should assume that we already have cassandra key space killer underscore video and empty table deniro ratings with columns trading and count the query itself should look familiar as it only differs from the previous example in the last two lines instead of ordering and displaying the result we use spark cassandra connector to save the result into cassandra if the saving to cassandra code looks new to you consider taking our course on data stacks enterprise analytics with apache sparks on data stacks academy to learn more lastly we use spark sql to receive data back from the cassandra table to see if we indeed achieved our goal and finally we have our most complex example where we find and compare rating distributions for al pacino and robert de niro by retrieving and combining data from both graph and cassandra that should be interesting we get al pacino's rating distribution from the graph and robert the nearest rating distribution from the table in cassandra we populated in the previous example we then take the two resulting data frames or tables and perform a full outer join on the rating column the full outer join is required to preserve any rows from both tables that cannot satisfy the join condition we order the resulting table by rating and show the result you should be able to recognize that the query uses a number of apis dsc graph frames spar graph frames data frames spark cassandra connector and spark sql there are so many possibilities and now you have an opportunity to practice some of those skills [Music]",
    "segments": [
      {
        "start": 1.42,
        "duration": 3.2,
        "text": "[Music]"
      },
      {
        "start": 4.96,
        "duration": 4.24,
        "text": "hi i am artem chubatko and this is using"
      },
      {
        "start": 7.04,
        "duration": 4.4,
        "text": "sparkgraph frame api with the ac"
      },
      {
        "start": 9.2,
        "duration": 3.12,
        "text": "graph frames as you may have already"
      },
      {
        "start": 11.44,
        "duration": 2.72,
        "text": "noticed"
      },
      {
        "start": 12.32,
        "duration": 4.56,
        "text": "there are the ac graph frames and there"
      },
      {
        "start": 14.16,
        "duration": 3.44,
        "text": "are spar graph frames are they related"
      },
      {
        "start": 16.88,
        "duration": 3.84,
        "text": "and how"
      },
      {
        "start": 17.6,
        "duration": 3.759,
        "text": "dc graph frame is an extension of graph"
      },
      {
        "start": 20.72,
        "duration": 3.04,
        "text": "frame"
      },
      {
        "start": 21.359,
        "duration": 4.24,
        "text": "it uses graph frame compatible data"
      },
      {
        "start": 23.76,
        "duration": 5.279,
        "text": "format and can be converted"
      },
      {
        "start": 25.599,
        "duration": 4.561,
        "text": "to graph frame implicitly or using meta"
      },
      {
        "start": 29.039,
        "duration": 2.801,
        "text": "gf"
      },
      {
        "start": 30.16,
        "duration": 3.919,
        "text": "in this presentation we will introduce"
      },
      {
        "start": 31.84,
        "duration": 2.8,
        "text": "some methods of the original graph frame"
      },
      {
        "start": 34.079,
        "duration": 2.801,
        "text": "api"
      },
      {
        "start": 34.64,
        "duration": 3.04,
        "text": "from spark we will work on the same"
      },
      {
        "start": 36.88,
        "duration": 3.04,
        "text": "examples"
      },
      {
        "start": 37.68,
        "duration": 4.32,
        "text": "that we also used in our presentation"
      },
      {
        "start": 39.92,
        "duration": 2.88,
        "text": "called using gremlin with dac graph"
      },
      {
        "start": 42.0,
        "duration": 3.2,
        "text": "frames"
      },
      {
        "start": 42.8,
        "duration": 4.48,
        "text": "so that you can easily compare gremlin"
      },
      {
        "start": 45.2,
        "duration": 4.64,
        "text": "and graph frame apis"
      },
      {
        "start": 47.28,
        "duration": 3.52,
        "text": "i personally prefer using gremlin but it"
      },
      {
        "start": 49.84,
        "duration": 3.6,
        "text": "is always"
      },
      {
        "start": 50.8,
        "duration": 3.599,
        "text": "good to have options these are the main"
      },
      {
        "start": 53.44,
        "duration": 3.68,
        "text": "categories of"
      },
      {
        "start": 54.399,
        "duration": 3.361,
        "text": "methods available in graph frame api"
      },
      {
        "start": 57.12,
        "duration": 3.84,
        "text": "namely"
      },
      {
        "start": 57.76,
        "duration": 6.399,
        "text": "motif finding graph topology"
      },
      {
        "start": 60.96,
        "duration": 4.32,
        "text": "graph structure graph algaes and graph"
      },
      {
        "start": 64.159,
        "duration": 3.28,
        "text": "persistence"
      },
      {
        "start": 65.28,
        "duration": 4.0,
        "text": "it will require a lot of time to learn"
      },
      {
        "start": 67.439,
        "duration": 3.841,
        "text": "about all of these methods"
      },
      {
        "start": 69.28,
        "duration": 3.44,
        "text": "so we will only focus on the most"
      },
      {
        "start": 71.28,
        "duration": 3.839,
        "text": "interesting one for us"
      },
      {
        "start": 72.72,
        "duration": 4.0,
        "text": "the method called find you can always"
      },
      {
        "start": 75.119,
        "duration": 3.601,
        "text": "find more information"
      },
      {
        "start": 76.72,
        "duration": 3.12,
        "text": "about the other methods in the spark"
      },
      {
        "start": 78.72,
        "duration": 3.36,
        "text": "documentation"
      },
      {
        "start": 79.84,
        "duration": 3.84,
        "text": "motif fighting is an interesting way to"
      },
      {
        "start": 82.08,
        "duration": 3.92,
        "text": "express graph queries"
      },
      {
        "start": 83.68,
        "duration": 3.04,
        "text": "using graph pattern matching this is"
      },
      {
        "start": 86.0,
        "duration": 2.88,
        "text": "similar to"
      },
      {
        "start": 86.72,
        "duration": 3.68,
        "text": "the clarity of gremlin traversals but"
      },
      {
        "start": 88.88,
        "duration": 4.4,
        "text": "the syntax is of course"
      },
      {
        "start": 90.4,
        "duration": 3.44,
        "text": "quite different and it does rely heavily"
      },
      {
        "start": 93.28,
        "duration": 3.44,
        "text": "on"
      },
      {
        "start": 93.84,
        "duration": 4.48,
        "text": "data frame api as well so the general"
      },
      {
        "start": 96.72,
        "duration": 4.88,
        "text": "strategy is to first create"
      },
      {
        "start": 98.32,
        "duration": 6.24,
        "text": "a dac graph frame for a particular graph"
      },
      {
        "start": 101.6,
        "duration": 3.519,
        "text": "that exists in dsc graph we call meta"
      },
      {
        "start": 104.56,
        "duration": 3.28,
        "text": "dec"
      },
      {
        "start": 105.119,
        "duration": 4.081,
        "text": "graph for killer video on the spark"
      },
      {
        "start": 107.84,
        "duration": 4.639,
        "text": "session object"
      },
      {
        "start": 109.2,
        "duration": 3.84,
        "text": "second we call method find and pass it a"
      },
      {
        "start": 112.479,
        "duration": 3.28,
        "text": "graph"
      },
      {
        "start": 113.04,
        "duration": 4.56,
        "text": "pattern that needs to be matched against"
      },
      {
        "start": 115.759,
        "duration": 5.521,
        "text": "our killer video graph"
      },
      {
        "start": 117.6,
        "duration": 5.44,
        "text": "next we augment motif finding with data"
      },
      {
        "start": 121.28,
        "duration": 4.72,
        "text": "frame api methods like"
      },
      {
        "start": 123.04,
        "duration": 3.52,
        "text": "filter and select finally we use a"
      },
      {
        "start": 126.0,
        "duration": 3.039,
        "text": "method"
      },
      {
        "start": 126.56,
        "duration": 4.16,
        "text": "that can trigger computation in spark"
      },
      {
        "start": 129.039,
        "duration": 5.2,
        "text": "such as data frames"
      },
      {
        "start": 130.72,
        "duration": 7.12,
        "text": "show in this example here are some rules"
      },
      {
        "start": 134.239,
        "duration": 4.481,
        "text": "about defining graph patterns a unit"
      },
      {
        "start": 137.84,
        "duration": 4.32,
        "text": "pattern"
      },
      {
        "start": 138.72,
        "duration": 4.239,
        "text": "is simply a directed edge with two end"
      },
      {
        "start": 142.16,
        "duration": 3.04,
        "text": "points"
      },
      {
        "start": 142.959,
        "duration": 3.041,
        "text": "all three components can be given"
      },
      {
        "start": 145.2,
        "duration": 4.72,
        "text": "arbitrary"
      },
      {
        "start": 146.0,
        "duration": 7.04,
        "text": "names such as a e and b in this example"
      },
      {
        "start": 149.92,
        "duration": 6.56,
        "text": "denoting that the pattern must match an"
      },
      {
        "start": 153.04,
        "duration": 5.68,
        "text": "h e from vertex a to vertex b"
      },
      {
        "start": 156.48,
        "duration": 5.039,
        "text": "multiple unit patterns can be combined"
      },
      {
        "start": 158.72,
        "duration": 5.84,
        "text": "into a larger pattern using semicolons"
      },
      {
        "start": 161.519,
        "duration": 4.321,
        "text": "which serve as conjunction operators in"
      },
      {
        "start": 164.56,
        "duration": 4.399,
        "text": "this example"
      },
      {
        "start": 165.84,
        "duration": 5.92,
        "text": "we have two edges from a to b"
      },
      {
        "start": 168.959,
        "duration": 4.801,
        "text": "to c if different patterns components"
      },
      {
        "start": 171.76,
        "duration": 4.64,
        "text": "share the same name"
      },
      {
        "start": 173.76,
        "duration": 3.199,
        "text": "it means that they should match the same"
      },
      {
        "start": 176.4,
        "duration": 4.16,
        "text": "graph"
      },
      {
        "start": 176.959,
        "duration": 6.721,
        "text": "elements such as b is used as an"
      },
      {
        "start": 180.56,
        "duration": 3.679,
        "text": "endpoint in one edge and also an end"
      },
      {
        "start": 183.68,
        "duration": 4.479,
        "text": "point"
      },
      {
        "start": 184.239,
        "duration": 7.041,
        "text": "in the other edge b must match a vertex"
      },
      {
        "start": 188.159,
        "duration": 4.641,
        "text": "that has an incoming and outgoing edges"
      },
      {
        "start": 191.28,
        "duration": 4.16,
        "text": "accordingly to the pattern"
      },
      {
        "start": 192.8,
        "duration": 3.359,
        "text": "vertex and edge names become column"
      },
      {
        "start": 195.44,
        "duration": 3.519,
        "text": "names"
      },
      {
        "start": 196.159,
        "duration": 4.0,
        "text": "in the resulting data frame also vertex"
      },
      {
        "start": 198.959,
        "duration": 4.0,
        "text": "and age names"
      },
      {
        "start": 200.159,
        "duration": 3.201,
        "text": "can be emitted if they are not needed to"
      },
      {
        "start": 202.959,
        "duration": 3.441,
        "text": "be"
      },
      {
        "start": 203.36,
        "duration": 6.08,
        "text": "in the resulting data frame finally an"
      },
      {
        "start": 206.4,
        "duration": 4.16,
        "text": "edge can be negated to indicate that the"
      },
      {
        "start": 209.44,
        "duration": 3.68,
        "text": "edge should not"
      },
      {
        "start": 210.56,
        "duration": 4.399,
        "text": "be present in the graph this is done"
      },
      {
        "start": 213.12,
        "duration": 4.32,
        "text": "using an exclamation mark"
      },
      {
        "start": 214.959,
        "duration": 3.28,
        "text": "in front of a unit pattern in this"
      },
      {
        "start": 217.44,
        "duration": 4.159,
        "text": "example"
      },
      {
        "start": 218.239,
        "duration": 6.481,
        "text": "we find edges from a to b such that"
      },
      {
        "start": 221.599,
        "duration": 5.601,
        "text": "there exists no edge from b to a"
      },
      {
        "start": 224.72,
        "duration": 3.84,
        "text": "this simple motif finding example uses a"
      },
      {
        "start": 227.2,
        "duration": 3.92,
        "text": "unit pattern to match"
      },
      {
        "start": 228.56,
        "duration": 3.36,
        "text": "all edges in our graph and returns a"
      },
      {
        "start": 231.12,
        "duration": 3.52,
        "text": "data frame"
      },
      {
        "start": 231.92,
        "duration": 3.679,
        "text": "with three columns we show the first"
      },
      {
        "start": 234.64,
        "duration": 4.4,
        "text": "five"
      },
      {
        "start": 235.599,
        "duration": 4.64,
        "text": "found edges likely this is not the most"
      },
      {
        "start": 239.04,
        "duration": 3.52,
        "text": "useful query"
      },
      {
        "start": 240.239,
        "duration": 3.121,
        "text": "you can think of to make things more"
      },
      {
        "start": 242.56,
        "duration": 3.2,
        "text": "interesting"
      },
      {
        "start": 243.36,
        "duration": 3.28,
        "text": "we need a way to restrict vertex and"
      },
      {
        "start": 245.76,
        "duration": 3.679,
        "text": "edge labels"
      },
      {
        "start": 246.64,
        "duration": 4.959,
        "text": "as well as property values this can be"
      },
      {
        "start": 249.439,
        "duration": 4.641,
        "text": "done with data frame api"
      },
      {
        "start": 251.599,
        "duration": 4.961,
        "text": "here is an incomplete list of data frame"
      },
      {
        "start": 254.08,
        "duration": 4.399,
        "text": "methods that you may find to be useful"
      },
      {
        "start": 256.56,
        "duration": 3.44,
        "text": "even if you are not very familiar with"
      },
      {
        "start": 258.479,
        "duration": 2.88,
        "text": "spark data frames"
      },
      {
        "start": 260.0,
        "duration": 3.28,
        "text": "the names of these matters are"
      },
      {
        "start": 261.359,
        "duration": 4.801,
        "text": "descriptive enough to infer"
      },
      {
        "start": 263.28,
        "duration": 4.88,
        "text": "their purpose we will see some of them"
      },
      {
        "start": 266.16,
        "duration": 4.24,
        "text": "used in the following examples"
      },
      {
        "start": 268.16,
        "duration": 4.24,
        "text": "furthermore there are many predefined"
      },
      {
        "start": 270.4,
        "duration": 5.04,
        "text": "functions that can help you define"
      },
      {
        "start": 272.4,
        "duration": 5.6,
        "text": "even more complex graph queries you can"
      },
      {
        "start": 275.44,
        "duration": 5.68,
        "text": "sort things do mathematical calculation"
      },
      {
        "start": 278.0,
        "duration": 6.08,
        "text": "compute aggregates extract substrings"
      },
      {
        "start": 281.12,
        "duration": 3.359,
        "text": "work with states and so forth again this"
      },
      {
        "start": 284.08,
        "duration": 3.04,
        "text": "is an"
      },
      {
        "start": 284.479,
        "duration": 5.041,
        "text": "incomplete list and you can read this"
      },
      {
        "start": 287.12,
        "duration": 4.72,
        "text": "part recommendation for more details"
      },
      {
        "start": 289.52,
        "duration": 3.52,
        "text": "now we are ready to do some damage this"
      },
      {
        "start": 291.84,
        "duration": 3.52,
        "text": "is a simple query"
      },
      {
        "start": 293.04,
        "duration": 4.08,
        "text": "that finds robert deniers movies from"
      },
      {
        "start": 295.36,
        "duration": 4.96,
        "text": "1970s"
      },
      {
        "start": 297.12,
        "duration": 6.16,
        "text": "we match edges with pattern movie e"
      },
      {
        "start": 300.32,
        "duration": 4.319,
        "text": "person and further require person's name"
      },
      {
        "start": 303.28,
        "duration": 4.32,
        "text": "to be robert deniro"
      },
      {
        "start": 304.639,
        "duration": 4.641,
        "text": "h label to be actor movie year to be"
      },
      {
        "start": 307.6,
        "duration": 5.12,
        "text": "greater than or equal to"
      },
      {
        "start": 309.28,
        "duration": 6.479,
        "text": "1970 and less than 1980. we select"
      },
      {
        "start": 312.72,
        "duration": 3.28,
        "text": "title and year failures of such movies"
      },
      {
        "start": 315.759,
        "duration": 3.361,
        "text": "and"
      },
      {
        "start": 316.0,
        "duration": 6.8,
        "text": "output them using dataframes method show"
      },
      {
        "start": 319.12,
        "duration": 5.919,
        "text": "the result contains three movies next"
      },
      {
        "start": 322.8,
        "duration": 3.28,
        "text": "we find rating distribution for over the"
      },
      {
        "start": 325.039,
        "duration": 3.761,
        "text": "nearest movies and"
      },
      {
        "start": 326.08,
        "duration": 3.839,
        "text": "all the results by rating our graph"
      },
      {
        "start": 328.8,
        "duration": 4.64,
        "text": "pattern consists of"
      },
      {
        "start": 329.919,
        "duration": 6.56,
        "text": "two unit patterns user rated movie"
      },
      {
        "start": 333.44,
        "duration": 4.64,
        "text": "and movie actor person a person name"
      },
      {
        "start": 336.479,
        "duration": 4.56,
        "text": "must be over the nearer"
      },
      {
        "start": 338.08,
        "duration": 3.6,
        "text": "and two edges must have labels rated and"
      },
      {
        "start": 341.039,
        "duration": 3.281,
        "text": "actor"
      },
      {
        "start": 341.68,
        "duration": 5.04,
        "text": "since we're only interested in ratings"
      },
      {
        "start": 344.32,
        "duration": 5.2,
        "text": "we select the rating property values"
      },
      {
        "start": 346.72,
        "duration": 3.919,
        "text": "group them by rating and count how many"
      },
      {
        "start": 349.52,
        "duration": 4.64,
        "text": "values we have"
      },
      {
        "start": 350.639,
        "duration": 6.721,
        "text": "per group finally we rename column count"
      },
      {
        "start": 354.16,
        "duration": 5.36,
        "text": "1 to simply count order"
      },
      {
        "start": 357.36,
        "duration": 3.2,
        "text": "by the rating column and show the"
      },
      {
        "start": 359.52,
        "duration": 4.16,
        "text": "results"
      },
      {
        "start": 360.56,
        "duration": 4.0,
        "text": "now we can go a bit further let's save"
      },
      {
        "start": 363.68,
        "duration": 3.12,
        "text": "the result of"
      },
      {
        "start": 364.56,
        "duration": 4.639,
        "text": "our analysis of robert denier's movie"
      },
      {
        "start": 366.8,
        "duration": 4.239,
        "text": "ratings into a cassandra table"
      },
      {
        "start": 369.199,
        "duration": 4.081,
        "text": "we should assume that we already have"
      },
      {
        "start": 371.039,
        "duration": 2.961,
        "text": "cassandra key space killer underscore"
      },
      {
        "start": 373.28,
        "duration": 3.84,
        "text": "video"
      },
      {
        "start": 374.0,
        "duration": 4.24,
        "text": "and empty table deniro ratings with"
      },
      {
        "start": 377.12,
        "duration": 4.079,
        "text": "columns trading"
      },
      {
        "start": 378.24,
        "duration": 3.84,
        "text": "and count the query itself should look"
      },
      {
        "start": 381.199,
        "duration": 3.44,
        "text": "familiar"
      },
      {
        "start": 382.08,
        "duration": 3.28,
        "text": "as it only differs from the previous"
      },
      {
        "start": 384.639,
        "duration": 3.521,
        "text": "example"
      },
      {
        "start": 385.36,
        "duration": 4.88,
        "text": "in the last two lines instead of"
      },
      {
        "start": 388.16,
        "duration": 4.72,
        "text": "ordering and displaying the result"
      },
      {
        "start": 390.24,
        "duration": 4.399,
        "text": "we use spark cassandra connector to save"
      },
      {
        "start": 392.88,
        "duration": 3.84,
        "text": "the result into cassandra"
      },
      {
        "start": 394.639,
        "duration": 4.721,
        "text": "if the saving to cassandra code looks"
      },
      {
        "start": 396.72,
        "duration": 4.0,
        "text": "new to you consider taking our course on"
      },
      {
        "start": 399.36,
        "duration": 4.0,
        "text": "data stacks enterprise"
      },
      {
        "start": 400.72,
        "duration": 4.72,
        "text": "analytics with apache sparks on data"
      },
      {
        "start": 403.36,
        "duration": 5.52,
        "text": "stacks academy to learn more"
      },
      {
        "start": 405.44,
        "duration": 4.4,
        "text": "lastly we use spark sql to receive data"
      },
      {
        "start": 408.88,
        "duration": 3.52,
        "text": "back from the"
      },
      {
        "start": 409.84,
        "duration": 3.919,
        "text": "cassandra table to see if we indeed"
      },
      {
        "start": 412.4,
        "duration": 4.079,
        "text": "achieved our goal"
      },
      {
        "start": 413.759,
        "duration": 3.681,
        "text": "and finally we have our most complex"
      },
      {
        "start": 416.479,
        "duration": 3.521,
        "text": "example"
      },
      {
        "start": 417.44,
        "duration": 3.68,
        "text": "where we find and compare rating"
      },
      {
        "start": 420.0,
        "duration": 3.84,
        "text": "distributions for"
      },
      {
        "start": 421.12,
        "duration": 4.88,
        "text": "al pacino and robert de niro by"
      },
      {
        "start": 423.84,
        "duration": 2.639,
        "text": "retrieving and combining data from both"
      },
      {
        "start": 426.0,
        "duration": 3.039,
        "text": "graph"
      },
      {
        "start": 426.479,
        "duration": 5.201,
        "text": "and cassandra that should be interesting"
      },
      {
        "start": 429.039,
        "duration": 4.56,
        "text": "we get al pacino's rating distribution"
      },
      {
        "start": 431.68,
        "duration": 3.76,
        "text": "from the graph and robert the nearest"
      },
      {
        "start": 433.599,
        "duration": 2.401,
        "text": "rating distribution from the table in"
      },
      {
        "start": 435.44,
        "duration": 3.28,
        "text": "cassandra"
      },
      {
        "start": 436.0,
        "duration": 5.599,
        "text": "we populated in the previous example we"
      },
      {
        "start": 438.72,
        "duration": 5.36,
        "text": "then take the two resulting data frames"
      },
      {
        "start": 441.599,
        "duration": 3.921,
        "text": "or tables and perform a full outer join"
      },
      {
        "start": 444.08,
        "duration": 3.519,
        "text": "on the rating column"
      },
      {
        "start": 445.52,
        "duration": 4.64,
        "text": "the full outer join is required to"
      },
      {
        "start": 447.599,
        "duration": 5.6,
        "text": "preserve any rows from both tables that"
      },
      {
        "start": 450.16,
        "duration": 5.439,
        "text": "cannot satisfy the join condition"
      },
      {
        "start": 453.199,
        "duration": 3.201,
        "text": "we order the resulting table by rating"
      },
      {
        "start": 455.599,
        "duration": 2.561,
        "text": "and show"
      },
      {
        "start": 456.4,
        "duration": 3.44,
        "text": "the result you should be able to"
      },
      {
        "start": 458.16,
        "duration": 5.759,
        "text": "recognize that the query"
      },
      {
        "start": 459.84,
        "duration": 6.16,
        "text": "uses a number of apis dsc graph frames"
      },
      {
        "start": 463.919,
        "duration": 5.201,
        "text": "spar graph frames"
      },
      {
        "start": 466.0,
        "duration": 5.68,
        "text": "data frames spark cassandra connector"
      },
      {
        "start": 469.12,
        "duration": 4.079,
        "text": "and spark sql there are so many"
      },
      {
        "start": 471.68,
        "duration": 3.28,
        "text": "possibilities"
      },
      {
        "start": 473.199,
        "duration": 4.911,
        "text": "and now you have an opportunity to"
      },
      {
        "start": 474.96,
        "duration": 6.369,
        "text": "practice some of those skills"
      },
      {
        "start": 478.11,
        "duration": 3.219,
        "text": "[Music]"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-15T23:01:41.847529+00:00"
}