{
  "video_id": "C7uAcytAzuk",
  "title": "DS320.08 Spark Essentials: RDD Transformations | DataStax Enterprise Analytics",
  "description": "#DataStaxAcademy #DS320\nDS320.08 Spark Essentials: RDD Transformations\nIn this course, you will learn how to effectively and efficiently solve analytical problems with Apache Spark™, Apache Cassandra™, and DataStax Enterprise. You will learn about the Spark API, Spark-Cassandra Connector, Spark SQL, Spark Streaming, and crucial performance optimization techniques.  You will also learn the basics of the productive and robust Scala programming language for data analysis and processing in Apache Spark™.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-16T00:26:14Z",
  "thumbnail": "https://i.ytimg.com/vi/C7uAcytAzuk/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "tutorial",
    "apache_cassandra",
    "performance",
    "datastax"
  ],
  "url": "https://www.youtube.com/watch?v=C7uAcytAzuk",
  "transcript": {
    "available": true,
    "language": "English (auto-generated)",
    "language_code": "en",
    "is_generated": true,
    "text": "[Music] now in the last section i briefly mentioned that there was a method called filter that took an rdd and turned it into another rdd that was an example of a transformation that's one of the key kinds of operations that we can perform on an rdd now transformation always takes an rdd as its input and returns an rdd as its output it never modifies the input rdd rdds are immutable so it can't modify it but it applies some kind of processing and creates a new rdd the new one might be bigger it might be smaller it might be the same size and it's going to be altered in some way based on the semantics of the transformation let's take a look at a few common transformations i know i've talked about what they are but i want to give you some examples of some real spark api calls and just talk through what they do we're only going to look at a few i will not drag you through the whole api here but to help flesh out this concept let's take a look at the slide the filter transformation which we already looked at creates a new rdd by selecting only certain elements out of the source rdd based on the return value of a function now that function gets the record of the source rdd passed into it you get to make some decision based on that record and determine whether it should make it into the output rdd or not map transforms the elements of the source rdd each one is passed to the function that you pass to map and that function gets to make some decision what am i going to do am i going to alter fields am i going to select certain fields it gets to transform the data in the source rdd to the destination rdd there's always a one-to-one correspondence between the data in the source and the data in the destination now flat map is similar except it kind of anticipates that it might need to break up the elements of the source rdd into multiple elements on the back end now suppose the source contained a line of text well flat map would be able to tokenize that text and return now a collection of elements so there is a one-to-many relationship from the source rdd to the output rdd so flatmap is like map except it anticipates that it's going to break up the element of the input rdd into multiple elements in the output rdd so it returns a sequence or a collection of things as if maybe you're tokenizing words on white space in a line of text your input rdd has a line and you're returning a sequence of words at out of flat map distinct is pretty simple if the input rdd elements are comparable to one another then distinct will return only unique elements so if there were duplicates on the input rdd the output rdd will have a smaller cardinality sample is kind of cool this is nice if you have really big data and you need a statistical sample you can indicate what fraction of the source rdd you'd like to see and even provide a seed if you want that sampling to look differently you can see that with the time or some other nonce that you've got lying around those are all unary transformations all of which take a single rdd apply some logic and output another rdd binary transformations take two rdds as input and return another rdd as output let's take a look at a few examples union intersection subtract and cartesian now union creates a new rdd containing the union of the elements from the source and the other with duplicates being allowed intersection returns all of the elements that are in the source rdd and the other rdd with duplicates being eliminated subtract returns a new rdd containing all of the elements of the source rdd that are not in the other rdd finally cartesian creates the cartesian product of the source rdd and the other rdd so the output rdd is going to have a cardinality much larger than the inputs but this is potentially useful and later on when we look at pair rdds we'll actually use this in an example okay now let me show you filter map distinct flat map and cartesian with some actual code we're going to start with this data this again is our list of movies a little bit enhanced to make it a little bit more interesting it's a collection of strings and it's got seven strings in it which are comma delimited title comma release year film data now let's filter that data we played with this earlier but i want to show you a little bit more practically how this works and by the way if you've got a spark shell available running in data stacks enterprise community edition please type this code along it'll help you a lot just to get your fingers on the keyboard now what we're doing is we're looking for movies from 2010 now there are a couple different ways to do this that technique on the top assumes that the last four characters of the rdd are going to be an integer and that's going to be the release here probably a slightly more robust but computationally less efficient way to do that is the second example there we are filtering movies again where we split on a comma take the last element of that sequence trim it convert it to an integer and away we go now we could imagine this movie database could get a little more sophisticated like maybe you want to apply some genres to it now doing that for real in a real movie database or a large database of videos well that's a major content problem and people are going to have to tag the movies and make decisions about about what they are here we're going to do something a little simpler because we're just getting started take a look at the code we take the movies 2010 rdd that we just created in the last step and we map it and that map method takes an anonymous function that we pass in the rdd element into it what we do is we take that rdd element and turn it into a tuple containing itself and a set of family and animation in other words we're adding the family and animation tags to every single movie in our two movie rdd and you can see in the table on the right now uh the results that we get we get a string and a set of strings it's the beginnings of a movie schema this is going to get a lot more realistic later on don't worry flat map and distinct let's look at these examples we'll take family movies that we created in just the last step and flat map it now the input to that function the input parameters will be a tuple of the movie string that combined title and year string and the second element of the tuple is going to be the set all right that's basically think of that as the two columns in the rdd what we're going to do with those in the mapping is really just pluck out that second one the genre field so that intermediate rdd that we create after flat map is shown in the diagram there that is a list of family animation family and animation duplicates in that middle intermediate rdd then we call distinct on that rdd and of course as you can see we get only family and animation as the final output now let's take that tiny little family genres rdd that we created it's got just two things in it and apply the cartesian transformation on it it's nice if you're going to play with cartesian to start with a small rdd so you don't get into any trouble let's look at the code we take family genres on that top line called cartesian with itself we are crossing it with itself now i could cross it with some other rdd but here this is the product of family genres with family genres that intermediate rdd we then filter to produce only those elements where the two genres are not the same so family family is a valid part of the cartesian product of our family genres table but it's not very interesting we just want to know the different combinations of tags uh not where they would all be the same so this would be in real life a good way of saying what sorts of tags coexist with one another in unique ways fortunately in our data set we get a pretty small combination but the code would be the same if the problem domain were a little bit bigger [Music] you",
    "segments": [
      {
        "start": 0.06,
        "duration": 3.45,
        "text": "[Music]"
      },
      {
        "start": 6.24,
        "duration": 2.88,
        "text": "now in the last section i briefly"
      },
      {
        "start": 7.52,
        "duration": 3.76,
        "text": "mentioned that there was a method called"
      },
      {
        "start": 9.12,
        "duration": 3.439,
        "text": "filter that took an rdd and turned it"
      },
      {
        "start": 11.28,
        "duration": 3.519,
        "text": "into another rdd"
      },
      {
        "start": 12.559,
        "duration": 3.681,
        "text": "that was an example of a transformation"
      },
      {
        "start": 14.799,
        "duration": 3.601,
        "text": "that's one of the key kinds of"
      },
      {
        "start": 16.24,
        "duration": 4.24,
        "text": "operations that we can perform on an rdd"
      },
      {
        "start": 18.4,
        "duration": 4.08,
        "text": "now transformation always takes an rdd"
      },
      {
        "start": 20.48,
        "duration": 4.0,
        "text": "as its input and returns an rdd"
      },
      {
        "start": 22.48,
        "duration": 4.24,
        "text": "as its output it never modifies the"
      },
      {
        "start": 24.48,
        "duration": 3.039,
        "text": "input rdd rdds are immutable so it can't"
      },
      {
        "start": 26.72,
        "duration": 2.559,
        "text": "modify it"
      },
      {
        "start": 27.519,
        "duration": 3.201,
        "text": "but it applies some kind of processing"
      },
      {
        "start": 29.279,
        "duration": 3.12,
        "text": "and creates a new rdd"
      },
      {
        "start": 30.72,
        "duration": 3.92,
        "text": "the new one might be bigger it might be"
      },
      {
        "start": 32.399,
        "duration": 4.641,
        "text": "smaller it might be the same size"
      },
      {
        "start": 34.64,
        "duration": 3.52,
        "text": "and it's going to be altered in some way"
      },
      {
        "start": 37.04,
        "duration": 2.08,
        "text": "based on the semantics of the"
      },
      {
        "start": 38.16,
        "duration": 2.48,
        "text": "transformation"
      },
      {
        "start": 39.12,
        "duration": 2.959,
        "text": "let's take a look at a few common"
      },
      {
        "start": 40.64,
        "duration": 2.48,
        "text": "transformations i know i've talked about"
      },
      {
        "start": 42.079,
        "duration": 2.081,
        "text": "what they are but i want to give you"
      },
      {
        "start": 43.12,
        "duration": 3.68,
        "text": "some examples"
      },
      {
        "start": 44.16,
        "duration": 3.36,
        "text": "of some real spark api calls and just"
      },
      {
        "start": 46.8,
        "duration": 2.16,
        "text": "talk through"
      },
      {
        "start": 47.52,
        "duration": 2.719,
        "text": "what they do we're only going to look at"
      },
      {
        "start": 48.96,
        "duration": 2.239,
        "text": "a few i will not drag you through the"
      },
      {
        "start": 50.239,
        "duration": 2.881,
        "text": "whole api here"
      },
      {
        "start": 51.199,
        "duration": 3.04,
        "text": "but to help flesh out this concept let's"
      },
      {
        "start": 53.12,
        "duration": 2.959,
        "text": "take a look at the slide"
      },
      {
        "start": 54.239,
        "duration": 4.081,
        "text": "the filter transformation which we"
      },
      {
        "start": 56.079,
        "duration": 2.96,
        "text": "already looked at creates a new rdd by"
      },
      {
        "start": 58.32,
        "duration": 2.8,
        "text": "selecting"
      },
      {
        "start": 59.039,
        "duration": 3.441,
        "text": "only certain elements out of the source"
      },
      {
        "start": 61.12,
        "duration": 3.999,
        "text": "rdd based"
      },
      {
        "start": 62.48,
        "duration": 3.6,
        "text": "on the return value of a function now"
      },
      {
        "start": 65.119,
        "duration": 3.601,
        "text": "that function"
      },
      {
        "start": 66.08,
        "duration": 3.2,
        "text": "gets the record of the source rdd passed"
      },
      {
        "start": 68.72,
        "duration": 2.48,
        "text": "into it"
      },
      {
        "start": 69.28,
        "duration": 3.04,
        "text": "you get to make some decision based on"
      },
      {
        "start": 71.2,
        "duration": 2.88,
        "text": "that record"
      },
      {
        "start": 72.32,
        "duration": 3.52,
        "text": "and determine whether it should make it"
      },
      {
        "start": 74.08,
        "duration": 4.399,
        "text": "into the output rdd or not"
      },
      {
        "start": 75.84,
        "duration": 3.52,
        "text": "map transforms the elements of the"
      },
      {
        "start": 78.479,
        "duration": 3.361,
        "text": "source rdd"
      },
      {
        "start": 79.36,
        "duration": 3.68,
        "text": "each one is passed to the function that"
      },
      {
        "start": 81.84,
        "duration": 2.56,
        "text": "you pass to map"
      },
      {
        "start": 83.04,
        "duration": 2.88,
        "text": "and that function gets to make some"
      },
      {
        "start": 84.4,
        "duration": 2.96,
        "text": "decision what am i going to do am i"
      },
      {
        "start": 85.92,
        "duration": 3.04,
        "text": "going to alter fields am i going to"
      },
      {
        "start": 87.36,
        "duration": 3.2,
        "text": "select certain fields it gets to"
      },
      {
        "start": 88.96,
        "duration": 4.08,
        "text": "transform the data"
      },
      {
        "start": 90.56,
        "duration": 3.36,
        "text": "in the source rdd to the destination rdd"
      },
      {
        "start": 93.04,
        "duration": 2.48,
        "text": "there's always a one-to-one"
      },
      {
        "start": 93.92,
        "duration": 3.04,
        "text": "correspondence between the data"
      },
      {
        "start": 95.52,
        "duration": 3.04,
        "text": "in the source and the data in the"
      },
      {
        "start": 96.96,
        "duration": 4.159,
        "text": "destination now flat map"
      },
      {
        "start": 98.56,
        "duration": 3.76,
        "text": "is similar except it kind of anticipates"
      },
      {
        "start": 101.119,
        "duration": 4.241,
        "text": "that it might need to"
      },
      {
        "start": 102.32,
        "duration": 5.28,
        "text": "break up the elements of the source rdd"
      },
      {
        "start": 105.36,
        "duration": 4.079,
        "text": "into multiple elements on the back end"
      },
      {
        "start": 107.6,
        "duration": 2.96,
        "text": "now suppose the source contained a line"
      },
      {
        "start": 109.439,
        "duration": 3.36,
        "text": "of text"
      },
      {
        "start": 110.56,
        "duration": 3.519,
        "text": "well flat map would be able to tokenize"
      },
      {
        "start": 112.799,
        "duration": 4.081,
        "text": "that text and return"
      },
      {
        "start": 114.079,
        "duration": 4.64,
        "text": "now a collection of elements so there is"
      },
      {
        "start": 116.88,
        "duration": 4.64,
        "text": "a one-to-many relationship"
      },
      {
        "start": 118.719,
        "duration": 4.561,
        "text": "from the source rdd to the output rdd so"
      },
      {
        "start": 121.52,
        "duration": 3.44,
        "text": "flatmap is like map"
      },
      {
        "start": 123.28,
        "duration": 3.76,
        "text": "except it anticipates that it's going to"
      },
      {
        "start": 124.96,
        "duration": 5.12,
        "text": "break up the element of the"
      },
      {
        "start": 127.04,
        "duration": 5.52,
        "text": "input rdd into multiple elements in the"
      },
      {
        "start": 130.08,
        "duration": 3.6,
        "text": "output rdd so it returns a sequence or a"
      },
      {
        "start": 132.56,
        "duration": 3.44,
        "text": "collection of things"
      },
      {
        "start": 133.68,
        "duration": 3.279,
        "text": "as if maybe you're tokenizing words on"
      },
      {
        "start": 136.0,
        "duration": 3.2,
        "text": "white space"
      },
      {
        "start": 136.959,
        "duration": 4.161,
        "text": "in a line of text your input rdd has a"
      },
      {
        "start": 139.2,
        "duration": 4.88,
        "text": "line and you're returning a"
      },
      {
        "start": 141.12,
        "duration": 3.68,
        "text": "sequence of words at out of flat map"
      },
      {
        "start": 144.08,
        "duration": 3.76,
        "text": "distinct"
      },
      {
        "start": 144.8,
        "duration": 5.04,
        "text": "is pretty simple if the input rdd"
      },
      {
        "start": 147.84,
        "duration": 4.24,
        "text": "elements are comparable to one another"
      },
      {
        "start": 149.84,
        "duration": 4.32,
        "text": "then distinct will return only"
      },
      {
        "start": 152.08,
        "duration": 4.0,
        "text": "unique elements so if there were"
      },
      {
        "start": 154.16,
        "duration": 4.4,
        "text": "duplicates on the input rdd the output"
      },
      {
        "start": 156.08,
        "duration": 4.159,
        "text": "rdd will have a smaller cardinality"
      },
      {
        "start": 158.56,
        "duration": 2.959,
        "text": "sample is kind of cool this is nice if"
      },
      {
        "start": 160.239,
        "duration": 2.401,
        "text": "you have really big data and you need a"
      },
      {
        "start": 161.519,
        "duration": 2.8,
        "text": "statistical sample"
      },
      {
        "start": 162.64,
        "duration": 3.679,
        "text": "you can indicate what fraction of the"
      },
      {
        "start": 164.319,
        "duration": 4.081,
        "text": "source rdd you'd like to see"
      },
      {
        "start": 166.319,
        "duration": 3.761,
        "text": "and even provide a seed if you want that"
      },
      {
        "start": 168.4,
        "duration": 3.6,
        "text": "sampling to look differently"
      },
      {
        "start": 170.08,
        "duration": 3.519,
        "text": "you can see that with the time or some"
      },
      {
        "start": 172.0,
        "duration": 3.519,
        "text": "other nonce that you've got lying around"
      },
      {
        "start": 173.599,
        "duration": 3.761,
        "text": "those are all unary transformations all"
      },
      {
        "start": 175.519,
        "duration": 2.481,
        "text": "of which take a single rdd apply some"
      },
      {
        "start": 177.36,
        "duration": 2.959,
        "text": "logic and"
      },
      {
        "start": 178.0,
        "duration": 3.599,
        "text": "output another rdd binary"
      },
      {
        "start": 180.319,
        "duration": 4.321,
        "text": "transformations take two"
      },
      {
        "start": 181.599,
        "duration": 4.801,
        "text": "rdds as input and return another rdd"
      },
      {
        "start": 184.64,
        "duration": 3.599,
        "text": "as output let's take a look at a few"
      },
      {
        "start": 186.4,
        "duration": 5.68,
        "text": "examples union intersection"
      },
      {
        "start": 188.239,
        "duration": 4.961,
        "text": "subtract and cartesian now union creates"
      },
      {
        "start": 192.08,
        "duration": 3.12,
        "text": "a new rdd"
      },
      {
        "start": 193.2,
        "duration": 3.039,
        "text": "containing the union of the elements"
      },
      {
        "start": 195.2,
        "duration": 3.2,
        "text": "from the source"
      },
      {
        "start": 196.239,
        "duration": 4.161,
        "text": "and the other with duplicates being"
      },
      {
        "start": 198.4,
        "duration": 3.759,
        "text": "allowed intersection returns"
      },
      {
        "start": 200.4,
        "duration": 4.479,
        "text": "all of the elements that are in the"
      },
      {
        "start": 202.159,
        "duration": 5.36,
        "text": "source rdd and the other rdd"
      },
      {
        "start": 204.879,
        "duration": 4.961,
        "text": "with duplicates being eliminated"
      },
      {
        "start": 207.519,
        "duration": 4.881,
        "text": "subtract returns a new rdd containing"
      },
      {
        "start": 209.84,
        "duration": 3.36,
        "text": "all of the elements of the source rdd"
      },
      {
        "start": 212.4,
        "duration": 3.6,
        "text": "that are not"
      },
      {
        "start": 213.2,
        "duration": 3.84,
        "text": "in the other rdd finally cartesian"
      },
      {
        "start": 216.0,
        "duration": 3.04,
        "text": "creates the cartesian"
      },
      {
        "start": 217.04,
        "duration": 4.559,
        "text": "product of the source rdd and the other"
      },
      {
        "start": 219.04,
        "duration": 4.08,
        "text": "rdd so the output rdd is going to have a"
      },
      {
        "start": 221.599,
        "duration": 3.521,
        "text": "cardinality much larger"
      },
      {
        "start": 223.12,
        "duration": 3.36,
        "text": "than the inputs but this is potentially"
      },
      {
        "start": 225.12,
        "duration": 3.199,
        "text": "useful and later on"
      },
      {
        "start": 226.48,
        "duration": 3.039,
        "text": "when we look at pair rdds we'll actually"
      },
      {
        "start": 228.319,
        "duration": 3.2,
        "text": "use this in"
      },
      {
        "start": 229.519,
        "duration": 3.121,
        "text": "an example okay now let me show you"
      },
      {
        "start": 231.519,
        "duration": 3.92,
        "text": "filter map"
      },
      {
        "start": 232.64,
        "duration": 3.84,
        "text": "distinct flat map and cartesian with"
      },
      {
        "start": 235.439,
        "duration": 3.281,
        "text": "some actual code"
      },
      {
        "start": 236.48,
        "duration": 3.52,
        "text": "we're going to start with this data this"
      },
      {
        "start": 238.72,
        "duration": 3.04,
        "text": "again is our"
      },
      {
        "start": 240.0,
        "duration": 3.2,
        "text": "list of movies a little bit enhanced to"
      },
      {
        "start": 241.76,
        "duration": 2.8,
        "text": "make it a little bit more interesting"
      },
      {
        "start": 243.2,
        "duration": 3.36,
        "text": "it's a collection of strings and it's"
      },
      {
        "start": 244.56,
        "duration": 2.8,
        "text": "got seven strings in it which are comma"
      },
      {
        "start": 246.56,
        "duration": 3.84,
        "text": "delimited"
      },
      {
        "start": 247.36,
        "duration": 5.28,
        "text": "title comma release year film data"
      },
      {
        "start": 250.4,
        "duration": 3.759,
        "text": "now let's filter that data we played"
      },
      {
        "start": 252.64,
        "duration": 2.799,
        "text": "with this earlier but i want to show you"
      },
      {
        "start": 254.159,
        "duration": 1.761,
        "text": "a little bit more practically how this"
      },
      {
        "start": 255.439,
        "duration": 1.92,
        "text": "works"
      },
      {
        "start": 255.92,
        "duration": 2.96,
        "text": "and by the way if you've got a spark"
      },
      {
        "start": 257.359,
        "duration": 2.961,
        "text": "shell available running in data stacks"
      },
      {
        "start": 258.88,
        "duration": 3.68,
        "text": "enterprise community edition"
      },
      {
        "start": 260.32,
        "duration": 3.12,
        "text": "please type this code along it'll help"
      },
      {
        "start": 262.56,
        "duration": 2.72,
        "text": "you a lot"
      },
      {
        "start": 263.44,
        "duration": 3.36,
        "text": "just to get your fingers on the keyboard"
      },
      {
        "start": 265.28,
        "duration": 2.08,
        "text": "now what we're doing is we're looking"
      },
      {
        "start": 266.8,
        "duration": 3.92,
        "text": "for"
      },
      {
        "start": 267.36,
        "duration": 4.64,
        "text": "movies from 2010 now there are a couple"
      },
      {
        "start": 270.72,
        "duration": 4.16,
        "text": "different ways to do this"
      },
      {
        "start": 272.0,
        "duration": 3.68,
        "text": "that technique on the top assumes that"
      },
      {
        "start": 274.88,
        "duration": 3.28,
        "text": "the last"
      },
      {
        "start": 275.68,
        "duration": 3.12,
        "text": "four characters of the rdd are going to"
      },
      {
        "start": 278.16,
        "duration": 2.0,
        "text": "be"
      },
      {
        "start": 278.8,
        "duration": 3.52,
        "text": "an integer and that's going to be the"
      },
      {
        "start": 280.16,
        "duration": 3.599,
        "text": "release here probably a slightly more"
      },
      {
        "start": 282.32,
        "duration": 2.8,
        "text": "robust but computationally less"
      },
      {
        "start": 283.759,
        "duration": 2.72,
        "text": "efficient way to do that is the second"
      },
      {
        "start": 285.12,
        "duration": 4.4,
        "text": "example"
      },
      {
        "start": 286.479,
        "duration": 6.321,
        "text": "there we are filtering movies again"
      },
      {
        "start": 289.52,
        "duration": 4.8,
        "text": "where we split on a comma take the last"
      },
      {
        "start": 292.8,
        "duration": 3.52,
        "text": "element of that sequence"
      },
      {
        "start": 294.32,
        "duration": 3.84,
        "text": "trim it convert it to an integer and"
      },
      {
        "start": 296.32,
        "duration": 2.72,
        "text": "away we go now we could imagine this"
      },
      {
        "start": 298.16,
        "duration": 2.72,
        "text": "movie database"
      },
      {
        "start": 299.04,
        "duration": 3.2,
        "text": "could get a little more sophisticated"
      },
      {
        "start": 300.88,
        "duration": 4.0,
        "text": "like maybe you want to apply"
      },
      {
        "start": 302.24,
        "duration": 3.04,
        "text": "some genres to it now doing that for"
      },
      {
        "start": 304.88,
        "duration": 2.319,
        "text": "real"
      },
      {
        "start": 305.28,
        "duration": 3.199,
        "text": "in a real movie database or a large"
      },
      {
        "start": 307.199,
        "duration": 3.681,
        "text": "database of videos"
      },
      {
        "start": 308.479,
        "duration": 3.601,
        "text": "well that's a major content problem and"
      },
      {
        "start": 310.88,
        "duration": 2.879,
        "text": "people are going to have to tag the"
      },
      {
        "start": 312.08,
        "duration": 3.52,
        "text": "movies and make decisions about"
      },
      {
        "start": 313.759,
        "duration": 3.521,
        "text": "about what they are here we're going to"
      },
      {
        "start": 315.6,
        "duration": 3.12,
        "text": "do something a little simpler"
      },
      {
        "start": 317.28,
        "duration": 3.12,
        "text": "because we're just getting started take"
      },
      {
        "start": 318.72,
        "duration": 3.919,
        "text": "a look at the code we take the movies"
      },
      {
        "start": 320.4,
        "duration": 3.12,
        "text": "2010 rdd that we just created in the"
      },
      {
        "start": 322.639,
        "duration": 3.84,
        "text": "last step"
      },
      {
        "start": 323.52,
        "duration": 4.48,
        "text": "and we map it and that map method takes"
      },
      {
        "start": 326.479,
        "duration": 4.401,
        "text": "an anonymous function"
      },
      {
        "start": 328.0,
        "duration": 3.84,
        "text": "that we pass in the rdd element into it"
      },
      {
        "start": 330.88,
        "duration": 3.84,
        "text": "what we do"
      },
      {
        "start": 331.84,
        "duration": 4.16,
        "text": "is we take that rdd element and turn it"
      },
      {
        "start": 334.72,
        "duration": 4.4,
        "text": "into a tuple"
      },
      {
        "start": 336.0,
        "duration": 4.16,
        "text": "containing itself and a set of family"
      },
      {
        "start": 339.12,
        "duration": 3.519,
        "text": "and animation"
      },
      {
        "start": 340.16,
        "duration": 4.319,
        "text": "in other words we're adding the family"
      },
      {
        "start": 342.639,
        "duration": 3.761,
        "text": "and animation tags to every single movie"
      },
      {
        "start": 344.479,
        "duration": 3.121,
        "text": "in our two movie rdd and you can see in"
      },
      {
        "start": 346.4,
        "duration": 2.639,
        "text": "the table on the right now"
      },
      {
        "start": 347.6,
        "duration": 3.039,
        "text": "uh the results that we get we get a"
      },
      {
        "start": 349.039,
        "duration": 3.921,
        "text": "string and a set of strings"
      },
      {
        "start": 350.639,
        "duration": 3.28,
        "text": "it's the beginnings of a movie schema"
      },
      {
        "start": 352.96,
        "duration": 2.799,
        "text": "this is going to get a lot more"
      },
      {
        "start": 353.919,
        "duration": 4.4,
        "text": "realistic later on don't worry"
      },
      {
        "start": 355.759,
        "duration": 3.521,
        "text": "flat map and distinct let's look at"
      },
      {
        "start": 358.319,
        "duration": 2.481,
        "text": "these examples"
      },
      {
        "start": 359.28,
        "duration": 3.039,
        "text": "we'll take family movies that we created"
      },
      {
        "start": 360.8,
        "duration": 4.16,
        "text": "in just the last step and"
      },
      {
        "start": 362.319,
        "duration": 4.32,
        "text": "flat map it now the input to that"
      },
      {
        "start": 364.96,
        "duration": 2.48,
        "text": "function the input parameters will be a"
      },
      {
        "start": 366.639,
        "duration": 3.921,
        "text": "tuple"
      },
      {
        "start": 367.44,
        "duration": 5.36,
        "text": "of the movie string that combined"
      },
      {
        "start": 370.56,
        "duration": 3.52,
        "text": "title and year string and the second"
      },
      {
        "start": 372.8,
        "duration": 1.76,
        "text": "element of the tuple is going to be the"
      },
      {
        "start": 374.08,
        "duration": 1.76,
        "text": "set"
      },
      {
        "start": 374.56,
        "duration": 3.759,
        "text": "all right that's basically think of that"
      },
      {
        "start": 375.84,
        "duration": 3.76,
        "text": "as the two columns in the rdd"
      },
      {
        "start": 378.319,
        "duration": 2.961,
        "text": "what we're going to do with those in the"
      },
      {
        "start": 379.6,
        "duration": 3.36,
        "text": "mapping is really just pluck out that"
      },
      {
        "start": 381.28,
        "duration": 4.0,
        "text": "second one the genre field"
      },
      {
        "start": 382.96,
        "duration": 4.4,
        "text": "so that intermediate rdd that we create"
      },
      {
        "start": 385.28,
        "duration": 2.639,
        "text": "after flat map is shown in the diagram"
      },
      {
        "start": 387.36,
        "duration": 3.36,
        "text": "there"
      },
      {
        "start": 387.919,
        "duration": 3.521,
        "text": "that is a list of family animation"
      },
      {
        "start": 390.72,
        "duration": 4.16,
        "text": "family"
      },
      {
        "start": 391.44,
        "duration": 5.92,
        "text": "and animation duplicates in that middle"
      },
      {
        "start": 394.88,
        "duration": 4.08,
        "text": "intermediate rdd then we call distinct"
      },
      {
        "start": 397.36,
        "duration": 2.16,
        "text": "on that rdd and of course as you can see"
      },
      {
        "start": 398.96,
        "duration": 2.88,
        "text": "we get"
      },
      {
        "start": 399.52,
        "duration": 4.239,
        "text": "only family and animation as the final"
      },
      {
        "start": 401.84,
        "duration": 3.04,
        "text": "output now let's take that tiny little"
      },
      {
        "start": 403.759,
        "duration": 2.72,
        "text": "family genres"
      },
      {
        "start": 404.88,
        "duration": 4.64,
        "text": "rdd that we created it's got just two"
      },
      {
        "start": 406.479,
        "duration": 5.041,
        "text": "things in it and apply the cartesian"
      },
      {
        "start": 409.52,
        "duration": 3.28,
        "text": "transformation on it it's nice if you're"
      },
      {
        "start": 411.52,
        "duration": 2.799,
        "text": "going to play with cartesian to start"
      },
      {
        "start": 412.8,
        "duration": 2.32,
        "text": "with a small rdd so you don't get into"
      },
      {
        "start": 414.319,
        "duration": 2.641,
        "text": "any trouble"
      },
      {
        "start": 415.12,
        "duration": 3.519,
        "text": "let's look at the code we take family"
      },
      {
        "start": 416.96,
        "duration": 3.76,
        "text": "genres on that top line"
      },
      {
        "start": 418.639,
        "duration": 3.521,
        "text": "called cartesian with itself we are"
      },
      {
        "start": 420.72,
        "duration": 3.28,
        "text": "crossing it with itself"
      },
      {
        "start": 422.16,
        "duration": 3.12,
        "text": "now i could cross it with some other rdd"
      },
      {
        "start": 424.0,
        "duration": 3.28,
        "text": "but here this is the product of family"
      },
      {
        "start": 425.28,
        "duration": 5.52,
        "text": "genres with family genres"
      },
      {
        "start": 427.28,
        "duration": 6.88,
        "text": "that intermediate rdd we then filter"
      },
      {
        "start": 430.8,
        "duration": 6.399,
        "text": "to produce only those elements where"
      },
      {
        "start": 434.16,
        "duration": 5.92,
        "text": "the two genres are not the same so"
      },
      {
        "start": 437.199,
        "duration": 4.161,
        "text": "family family is a valid part of the"
      },
      {
        "start": 440.08,
        "duration": 3.119,
        "text": "cartesian product"
      },
      {
        "start": 441.36,
        "duration": 3.04,
        "text": "of our family genres table but it's not"
      },
      {
        "start": 443.199,
        "duration": 2.72,
        "text": "very interesting we just want to know"
      },
      {
        "start": 444.4,
        "duration": 3.519,
        "text": "the different combinations"
      },
      {
        "start": 445.919,
        "duration": 3.601,
        "text": "of tags uh not where they would all be"
      },
      {
        "start": 447.919,
        "duration": 3.201,
        "text": "the same so this would be"
      },
      {
        "start": 449.52,
        "duration": 4.799,
        "text": "in real life a good way of saying what"
      },
      {
        "start": 451.12,
        "duration": 5.68,
        "text": "sorts of tags coexist with one another"
      },
      {
        "start": 454.319,
        "duration": 3.121,
        "text": "in unique ways fortunately in our data"
      },
      {
        "start": 456.8,
        "duration": 2.48,
        "text": "set"
      },
      {
        "start": 457.44,
        "duration": 3.039,
        "text": "we get a pretty small combination but"
      },
      {
        "start": 459.28,
        "duration": 6.19,
        "text": "the code would be the same if the"
      },
      {
        "start": 460.479,
        "duration": 8.16,
        "text": "problem domain were a little bit bigger"
      },
      {
        "start": 465.47,
        "duration": 5.25,
        "text": "[Music]"
      },
      {
        "start": 468.639,
        "duration": 2.081,
        "text": "you"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-15T23:50:37.440644+00:00"
}