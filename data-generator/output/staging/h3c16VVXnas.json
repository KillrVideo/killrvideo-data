{
  "video_id": "h3c16VVXnas",
  "title": "DS332.06 Bulk Mutations with DSE GraphFrames | DataStax Enterprise 6 Graph Analytics",
  "description": "#DataStaxAcademy #DS332\nDS332.06 Bulk Mutations with DSE GraphFrames\nDSE GraphFrames are great for performing bulk mutations. When you need to insert, update or delete a large number of vertices, edges, and properties, you can use DSE GraphFrames for the best efficiency. That includes bulk loading an existing dataset into DataStax Enterprise Graph initially. In this unit, you will learn about bulk mutations with DSE GraphFrames.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-16T00:39:27Z",
  "thumbnail": "https://i.ytimg.com/vi/h3c16VVXnas/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "tutorial",
    "apache_cassandra",
    "dse",
    "datastax"
  ],
  "url": "https://www.youtube.com/watch?v=h3c16VVXnas",
  "transcript": {
    "available": true,
    "language": "English (auto-generated)",
    "language_code": "en",
    "is_generated": true,
    "text": "[Music] hi i am artem chibatko and this is bulk mutations with dec graph frames these cigar frames are great for performing valve mutations when you need to insert update or delete a large number of vertices edges and properties you can use dhc graph frames for the best efficiency that includes bulk loading an existing data set into dac graph initially here is the api for inserting updated and deleting graph elements using dsc graph frames notice that the same methods update vertices and update edges are used for both inserting and updating data in graph the way it works is as follows dac graph does not do read before a write to verify that something already exists in the graph instead for efficiency we simply write data which results in inserting a vertex or an h if it did not exist before or updating an existing vertex or an edge with new property values if it existed before this is also consistent with how absurds work in cassandra if you are familiar with this notion also notice that all methods take a data frame as a parameter data frame df must have columns and values that uniquely identify vertices and edges that are being inserted updated or deleted for example in case of a vertex we need a vertex label and vertex id properties in case of an edge we need an edge label as well as source and destination vertex ids in addition the data frame should have columns representing properties that are being inserted or updated also when inserting or updating vertices an optional set of vertex labels can be specified for better efficiency when deleting vertex or edge properties to be deleted property names needs to be passed to delete vertex properties and delete edge properties that may be a lot of information for now so let's look at some examples and see those methods in action first we need a data source or some existing data set that can be inserted into dsc graph anything that is accessible via spark will work that includes files in local and distributed file systems nosql databases relational databases data streams and so on for the sake of our examples it makes sense to choose a cassandra database as a data source this is the cassandra database schema we can use we have three tables users movies and ratings by user take a look at the columns in those tables you should be able to recognize that the tables users and movies have data that belongs to vertices in our kilo video domain and table ratings by user has information about rated edges such as users rated movies with particular ratings it is how some sample data in those tables may look like we insert one user u1234 who is a 32 year old female and we also insert two movies m1111 moana and m 2222 beauty and the beast our user left the ratings of 9 and 8 to those movies respectively you can of course assume that there are many more rows in each table we can assume that we have an empty killer video graph created in dc graph and this is its schema we first defined property keys such as user id age gender movie id title year duration country production and rating we then defined two vertex labels and one edge label by now you are likely familiar with these definitions and this index finally interesting things start happening here we initialize a d frame for the killer videographer schema you have just seen we retrieve data from cassandra table users into a data frame using a spark sql query we then call update vertices to insert each row in the data frame as a user vertex with user id age and gender properties into the killer video graph in dsc graph the optional sequence user parameter is used to make data insertion faster we display the contents of the data frame just for the reference the data has actually been inserted to the graph now that was almost too easy the only data transformation that we had to do is hard coding the user label in the sql select clause because the user table has no column that stores a vertex label which is to be expected next we use the same strategy to insert our two movies sql query over the movies cassandra table update vertices to insert into the killer video graph show the data frame content for the reference now let's see how we can insert rated edges into the graph we then retrieve data using a spark sql query but then we also post process the resulting data frame we need to add columns for edge endpoints namely source and destination which we do in the select method call to generate values for the source and destination columns we use method id column of the easy graph frame and pass it a vertex label and any properties that constitute a vertex id we use meta update edges to insert new edges in the graph and you can see how the data in the data frame looks like to understand what it takes to insert edges when we visualize our newly populated graph in data stack study we can see that we did a great job the user vertex two movie vertices and two rated edges are all present and their properties are there as well so now we have a graph with existing vertices edges and properties and it is a good time to do some updates let's change the user age from 32 to 23. we still use the update vertices method but we do create a data frame manually using the create data frame method of the spark session object we pass an rdd with a single row with values u1234 and 23 and also specify the data frame schema with fields user id and age in addition we add another column for label with value user you can see the resulting data frame in the output notice that we do not have a column for user gender because we do not need to update it let's also change the movie rating from 8 to 5 for one of the movies this time instead of creating a data frame with the edge information manually we can retrieve it from the graph itself we access edges through the dsc graph frame and filter them to have specific source and destination vertex ids then we select data frame columns that we need to identify an edge and add the rating column with a new value of 5 that we are updating the update ages method does the rest of the work for us we are done with insertions and updates what about deletions here is how we can delete all rated edges with rating 5 and all movie vertices with title beauty and the beast that should leave us with one user vertex one movie vertex and the edge between them as shown in this illustration finally our last example shows how to delete vertex and edge properties using methods delete vertex properties and delete edge properties we delete country and duration properties of them on a movie and the radiant property of all rated edges looks very straightforward to me in this exercise you will bulk load data from csv files into the killer video graph this is a pretty common scenario let's do it",
    "segments": [
      {
        "start": 1.42,
        "duration": 3.2,
        "text": "[Music]"
      },
      {
        "start": 5.2,
        "duration": 2.48,
        "text": "hi"
      },
      {
        "start": 5.6,
        "duration": 4.56,
        "text": "i am artem chibatko and this is bulk"
      },
      {
        "start": 7.68,
        "duration": 4.24,
        "text": "mutations with dec graph frames"
      },
      {
        "start": 10.16,
        "duration": 4.0,
        "text": "these cigar frames are great for"
      },
      {
        "start": 11.92,
        "duration": 3.04,
        "text": "performing valve mutations when you need"
      },
      {
        "start": 14.16,
        "duration": 2.72,
        "text": "to insert"
      },
      {
        "start": 14.96,
        "duration": 3.04,
        "text": "update or delete a large number of"
      },
      {
        "start": 16.88,
        "duration": 3.36,
        "text": "vertices edges"
      },
      {
        "start": 18.0,
        "duration": 4.24,
        "text": "and properties you can use dhc graph"
      },
      {
        "start": 20.24,
        "duration": 3.92,
        "text": "frames for the best efficiency"
      },
      {
        "start": 22.24,
        "duration": 3.84,
        "text": "that includes bulk loading an existing"
      },
      {
        "start": 24.16,
        "duration": 4.56,
        "text": "data set into dac graph"
      },
      {
        "start": 26.08,
        "duration": 4.56,
        "text": "initially here is the api for inserting"
      },
      {
        "start": 28.72,
        "duration": 3.679,
        "text": "updated and deleting graph elements"
      },
      {
        "start": 30.64,
        "duration": 3.599,
        "text": "using dsc graph frames"
      },
      {
        "start": 32.399,
        "duration": 3.121,
        "text": "notice that the same methods update"
      },
      {
        "start": 34.239,
        "duration": 3.921,
        "text": "vertices and update"
      },
      {
        "start": 35.52,
        "duration": 3.52,
        "text": "edges are used for both inserting and"
      },
      {
        "start": 38.16,
        "duration": 3.44,
        "text": "updating"
      },
      {
        "start": 39.04,
        "duration": 3.519,
        "text": "data in graph the way it works is as"
      },
      {
        "start": 41.6,
        "duration": 3.68,
        "text": "follows"
      },
      {
        "start": 42.559,
        "duration": 3.361,
        "text": "dac graph does not do read before a"
      },
      {
        "start": 45.28,
        "duration": 2.88,
        "text": "write"
      },
      {
        "start": 45.92,
        "duration": 3.119,
        "text": "to verify that something already exists"
      },
      {
        "start": 48.16,
        "duration": 2.8,
        "text": "in the graph"
      },
      {
        "start": 49.039,
        "duration": 4.801,
        "text": "instead for efficiency we simply write"
      },
      {
        "start": 50.96,
        "duration": 3.279,
        "text": "data which results in inserting a vertex"
      },
      {
        "start": 53.84,
        "duration": 4.16,
        "text": "or an"
      },
      {
        "start": 54.239,
        "duration": 5.84,
        "text": "h if it did not exist before or updating"
      },
      {
        "start": 58.0,
        "duration": 4.8,
        "text": "an existing vertex or an edge"
      },
      {
        "start": 60.079,
        "duration": 3.521,
        "text": "with new property values if it existed"
      },
      {
        "start": 62.8,
        "duration": 3.04,
        "text": "before"
      },
      {
        "start": 63.6,
        "duration": 4.16,
        "text": "this is also consistent with how absurds"
      },
      {
        "start": 65.84,
        "duration": 3.2,
        "text": "work in cassandra if you are familiar"
      },
      {
        "start": 67.76,
        "duration": 4.08,
        "text": "with this notion"
      },
      {
        "start": 69.04,
        "duration": 4.8,
        "text": "also notice that all methods take a data"
      },
      {
        "start": 71.84,
        "duration": 5.2,
        "text": "frame as a parameter"
      },
      {
        "start": 73.84,
        "duration": 3.84,
        "text": "data frame df must have columns and"
      },
      {
        "start": 77.04,
        "duration": 2.88,
        "text": "values"
      },
      {
        "start": 77.68,
        "duration": 3.84,
        "text": "that uniquely identify vertices and"
      },
      {
        "start": 79.92,
        "duration": 4.559,
        "text": "edges that are being inserted"
      },
      {
        "start": 81.52,
        "duration": 3.919,
        "text": "updated or deleted for example in case"
      },
      {
        "start": 84.479,
        "duration": 3.521,
        "text": "of a vertex"
      },
      {
        "start": 85.439,
        "duration": 3.68,
        "text": "we need a vertex label and vertex id"
      },
      {
        "start": 88.0,
        "duration": 4.479,
        "text": "properties"
      },
      {
        "start": 89.119,
        "duration": 5.521,
        "text": "in case of an edge we need an edge label"
      },
      {
        "start": 92.479,
        "duration": 3.041,
        "text": "as well as source and destination vertex"
      },
      {
        "start": 94.64,
        "duration": 3.439,
        "text": "ids"
      },
      {
        "start": 95.52,
        "duration": 3.2,
        "text": "in addition the data frame should have"
      },
      {
        "start": 98.079,
        "duration": 2.881,
        "text": "columns"
      },
      {
        "start": 98.72,
        "duration": 4.16,
        "text": "representing properties that are being"
      },
      {
        "start": 100.96,
        "duration": 4.32,
        "text": "inserted or updated"
      },
      {
        "start": 102.88,
        "duration": 4.559,
        "text": "also when inserting or updating vertices"
      },
      {
        "start": 105.28,
        "duration": 5.199,
        "text": "an optional set of vertex labels"
      },
      {
        "start": 107.439,
        "duration": 5.04,
        "text": "can be specified for better efficiency"
      },
      {
        "start": 110.479,
        "duration": 4.081,
        "text": "when deleting vertex or edge properties"
      },
      {
        "start": 112.479,
        "duration": 4.561,
        "text": "to be deleted property names"
      },
      {
        "start": 114.56,
        "duration": 3.599,
        "text": "needs to be passed to delete vertex"
      },
      {
        "start": 117.04,
        "duration": 3.679,
        "text": "properties and delete"
      },
      {
        "start": 118.159,
        "duration": 3.441,
        "text": "edge properties that may be a lot of"
      },
      {
        "start": 120.719,
        "duration": 3.36,
        "text": "information"
      },
      {
        "start": 121.6,
        "duration": 3.119,
        "text": "for now so let's look at some examples"
      },
      {
        "start": 124.079,
        "duration": 3.601,
        "text": "and see"
      },
      {
        "start": 124.719,
        "duration": 5.52,
        "text": "those methods in action first we need a"
      },
      {
        "start": 127.68,
        "duration": 5.919,
        "text": "data source or some existing data set"
      },
      {
        "start": 130.239,
        "duration": 6.321,
        "text": "that can be inserted into dsc graph"
      },
      {
        "start": 133.599,
        "duration": 3.601,
        "text": "anything that is accessible via spark"
      },
      {
        "start": 136.56,
        "duration": 2.72,
        "text": "will work"
      },
      {
        "start": 137.2,
        "duration": 3.84,
        "text": "that includes files in local and"
      },
      {
        "start": 139.28,
        "duration": 4.959,
        "text": "distributed file systems"
      },
      {
        "start": 141.04,
        "duration": 5.839,
        "text": "nosql databases relational databases"
      },
      {
        "start": 144.239,
        "duration": 3.681,
        "text": "data streams and so on for the sake of"
      },
      {
        "start": 146.879,
        "duration": 2.641,
        "text": "our examples"
      },
      {
        "start": 147.92,
        "duration": 3.84,
        "text": "it makes sense to choose a cassandra"
      },
      {
        "start": 149.52,
        "duration": 4.56,
        "text": "database as a data source"
      },
      {
        "start": 151.76,
        "duration": 3.52,
        "text": "this is the cassandra database schema we"
      },
      {
        "start": 154.08,
        "duration": 4.32,
        "text": "can use"
      },
      {
        "start": 155.28,
        "duration": 3.76,
        "text": "we have three tables users movies and"
      },
      {
        "start": 158.4,
        "duration": 2.72,
        "text": "ratings"
      },
      {
        "start": 159.04,
        "duration": 3.04,
        "text": "by user take a look at the columns in"
      },
      {
        "start": 161.12,
        "duration": 2.96,
        "text": "those tables"
      },
      {
        "start": 162.08,
        "duration": 4.32,
        "text": "you should be able to recognize that the"
      },
      {
        "start": 164.08,
        "duration": 4.4,
        "text": "tables users and movies"
      },
      {
        "start": 166.4,
        "duration": 3.76,
        "text": "have data that belongs to vertices in"
      },
      {
        "start": 168.48,
        "duration": 3.6,
        "text": "our kilo video domain"
      },
      {
        "start": 170.16,
        "duration": 3.2,
        "text": "and table ratings by user has"
      },
      {
        "start": 172.08,
        "duration": 4.72,
        "text": "information about"
      },
      {
        "start": 173.36,
        "duration": 4.4,
        "text": "rated edges such as users rated movies"
      },
      {
        "start": 176.8,
        "duration": 3.92,
        "text": "with particular"
      },
      {
        "start": 177.76,
        "duration": 5.04,
        "text": "ratings it is how some sample data in"
      },
      {
        "start": 180.72,
        "duration": 5.519,
        "text": "those tables may look like"
      },
      {
        "start": 182.8,
        "duration": 6.56,
        "text": "we insert one user u1234"
      },
      {
        "start": 186.239,
        "duration": 4.92,
        "text": "who is a 32 year old female and we also"
      },
      {
        "start": 189.36,
        "duration": 4.64,
        "text": "insert two movies"
      },
      {
        "start": 191.159,
        "duration": 6.44,
        "text": "m1111 moana and"
      },
      {
        "start": 194.0,
        "duration": 6.879,
        "text": "m 2222 beauty and the beast"
      },
      {
        "start": 197.599,
        "duration": 6.321,
        "text": "our user left the ratings of 9"
      },
      {
        "start": 200.879,
        "duration": 4.961,
        "text": "and 8 to those movies respectively"
      },
      {
        "start": 203.92,
        "duration": 3.28,
        "text": "you can of course assume that there are"
      },
      {
        "start": 205.84,
        "duration": 3.92,
        "text": "many more rows"
      },
      {
        "start": 207.2,
        "duration": 4.72,
        "text": "in each table we can assume that we have"
      },
      {
        "start": 209.76,
        "duration": 3.039,
        "text": "an empty killer video graph created in"
      },
      {
        "start": 211.92,
        "duration": 3.52,
        "text": "dc graph"
      },
      {
        "start": 212.799,
        "duration": 3.601,
        "text": "and this is its schema we first defined"
      },
      {
        "start": 215.44,
        "duration": 4.159,
        "text": "property keys"
      },
      {
        "start": 216.4,
        "duration": 6.399,
        "text": "such as user id age gender"
      },
      {
        "start": 219.599,
        "duration": 3.841,
        "text": "movie id title year duration country"
      },
      {
        "start": 222.799,
        "duration": 3.44,
        "text": "production"
      },
      {
        "start": 223.44,
        "duration": 3.68,
        "text": "and rating we then defined two vertex"
      },
      {
        "start": 226.239,
        "duration": 3.521,
        "text": "labels"
      },
      {
        "start": 227.12,
        "duration": 3.36,
        "text": "and one edge label by now you are likely"
      },
      {
        "start": 229.76,
        "duration": 3.839,
        "text": "familiar"
      },
      {
        "start": 230.48,
        "duration": 5.6,
        "text": "with these definitions and this index"
      },
      {
        "start": 233.599,
        "duration": 3.681,
        "text": "finally interesting things start"
      },
      {
        "start": 236.08,
        "duration": 4.32,
        "text": "happening here"
      },
      {
        "start": 237.28,
        "duration": 5.44,
        "text": "we initialize a d frame for the killer"
      },
      {
        "start": 240.4,
        "duration": 4.32,
        "text": "videographer schema you have just seen"
      },
      {
        "start": 242.72,
        "duration": 4.079,
        "text": "we retrieve data from cassandra table"
      },
      {
        "start": 244.72,
        "duration": 5.84,
        "text": "users into a data frame"
      },
      {
        "start": 246.799,
        "duration": 4.881,
        "text": "using a spark sql query we then call"
      },
      {
        "start": 250.56,
        "duration": 4.0,
        "text": "update vertices"
      },
      {
        "start": 251.68,
        "duration": 4.08,
        "text": "to insert each row in the data frame as"
      },
      {
        "start": 254.56,
        "duration": 4.72,
        "text": "a user vertex"
      },
      {
        "start": 255.76,
        "duration": 7.28,
        "text": "with user id age and gender properties"
      },
      {
        "start": 259.28,
        "duration": 6.08,
        "text": "into the killer video graph in dsc graph"
      },
      {
        "start": 263.04,
        "duration": 3.439,
        "text": "the optional sequence user parameter is"
      },
      {
        "start": 265.36,
        "duration": 3.44,
        "text": "used to make"
      },
      {
        "start": 266.479,
        "duration": 4.0,
        "text": "data insertion faster we display the"
      },
      {
        "start": 268.8,
        "duration": 3.839,
        "text": "contents of the data frame"
      },
      {
        "start": 270.479,
        "duration": 3.521,
        "text": "just for the reference the data has"
      },
      {
        "start": 272.639,
        "duration": 3.84,
        "text": "actually been inserted"
      },
      {
        "start": 274.0,
        "duration": 3.04,
        "text": "to the graph now that was almost too"
      },
      {
        "start": 276.479,
        "duration": 3.121,
        "text": "easy"
      },
      {
        "start": 277.04,
        "duration": 3.12,
        "text": "the only data transformation that we had"
      },
      {
        "start": 279.6,
        "duration": 4.319,
        "text": "to do"
      },
      {
        "start": 280.16,
        "duration": 6.64,
        "text": "is hard coding the user label in the sql"
      },
      {
        "start": 283.919,
        "duration": 4.241,
        "text": "select clause because the user table has"
      },
      {
        "start": 286.8,
        "duration": 4.32,
        "text": "no column that stores"
      },
      {
        "start": 288.16,
        "duration": 4.96,
        "text": "a vertex label which is to be expected"
      },
      {
        "start": 291.12,
        "duration": 5.12,
        "text": "next we use the same strategy"
      },
      {
        "start": 293.12,
        "duration": 5.84,
        "text": "to insert our two movies"
      },
      {
        "start": 296.24,
        "duration": 3.679,
        "text": "sql query over the movies cassandra"
      },
      {
        "start": 298.96,
        "duration": 2.799,
        "text": "table"
      },
      {
        "start": 299.919,
        "duration": 3.601,
        "text": "update vertices to insert into the"
      },
      {
        "start": 301.759,
        "duration": 4.16,
        "text": "killer video graph"
      },
      {
        "start": 303.52,
        "duration": 3.44,
        "text": "show the data frame content for the"
      },
      {
        "start": 305.919,
        "duration": 3.601,
        "text": "reference"
      },
      {
        "start": 306.96,
        "duration": 3.04,
        "text": "now let's see how we can insert rated"
      },
      {
        "start": 309.52,
        "duration": 3.04,
        "text": "edges"
      },
      {
        "start": 310.0,
        "duration": 3.039,
        "text": "into the graph we then retrieve data"
      },
      {
        "start": 312.56,
        "duration": 3.76,
        "text": "using"
      },
      {
        "start": 313.039,
        "duration": 6.481,
        "text": "a spark sql query but then we also post"
      },
      {
        "start": 316.32,
        "duration": 3.76,
        "text": "process the resulting data frame we need"
      },
      {
        "start": 319.52,
        "duration": 3.84,
        "text": "to add"
      },
      {
        "start": 320.08,
        "duration": 4.32,
        "text": "columns for edge endpoints namely source"
      },
      {
        "start": 323.36,
        "duration": 4.24,
        "text": "and destination"
      },
      {
        "start": 324.4,
        "duration": 3.76,
        "text": "which we do in the select method call to"
      },
      {
        "start": 327.6,
        "duration": 2.56,
        "text": "generate"
      },
      {
        "start": 328.16,
        "duration": 4.72,
        "text": "values for the source and destination"
      },
      {
        "start": 330.16,
        "duration": 4.0,
        "text": "columns we use method id column of the"
      },
      {
        "start": 332.88,
        "duration": 4.24,
        "text": "easy graph frame"
      },
      {
        "start": 334.16,
        "duration": 5.28,
        "text": "and pass it a vertex label and any"
      },
      {
        "start": 337.12,
        "duration": 5.919,
        "text": "properties that constitute a vertex"
      },
      {
        "start": 339.44,
        "duration": 6.4,
        "text": "id we use meta update edges to insert"
      },
      {
        "start": 343.039,
        "duration": 4.561,
        "text": "new edges in the graph and you can see"
      },
      {
        "start": 345.84,
        "duration": 3.52,
        "text": "how the data in the data frame"
      },
      {
        "start": 347.6,
        "duration": 3.2,
        "text": "looks like to understand what it takes"
      },
      {
        "start": 349.36,
        "duration": 4.0,
        "text": "to insert edges"
      },
      {
        "start": 350.8,
        "duration": 4.64,
        "text": "when we visualize our newly populated"
      },
      {
        "start": 353.36,
        "duration": 3.679,
        "text": "graph in data stack study we can see"
      },
      {
        "start": 355.44,
        "duration": 4.479,
        "text": "that we did a great job"
      },
      {
        "start": 357.039,
        "duration": 3.361,
        "text": "the user vertex two movie vertices and"
      },
      {
        "start": 359.919,
        "duration": 3.361,
        "text": "two"
      },
      {
        "start": 360.4,
        "duration": 3.68,
        "text": "rated edges are all present and their"
      },
      {
        "start": 363.28,
        "duration": 2.96,
        "text": "properties"
      },
      {
        "start": 364.08,
        "duration": 3.6,
        "text": "are there as well so now we have a graph"
      },
      {
        "start": 366.24,
        "duration": 3.6,
        "text": "with existing vertices"
      },
      {
        "start": 367.68,
        "duration": 3.92,
        "text": "edges and properties and it is a good"
      },
      {
        "start": 369.84,
        "duration": 5.6,
        "text": "time to do some updates"
      },
      {
        "start": 371.6,
        "duration": 6.48,
        "text": "let's change the user age from 32 to 23."
      },
      {
        "start": 375.44,
        "duration": 3.759,
        "text": "we still use the update vertices method"
      },
      {
        "start": 378.08,
        "duration": 3.839,
        "text": "but we do create"
      },
      {
        "start": 379.199,
        "duration": 5.041,
        "text": "a data frame manually using the create"
      },
      {
        "start": 381.919,
        "duration": 5.601,
        "text": "data frame method of the spark"
      },
      {
        "start": 384.24,
        "duration": 7.28,
        "text": "session object we pass an rdd"
      },
      {
        "start": 387.52,
        "duration": 7.519,
        "text": "with a single row with values u1234"
      },
      {
        "start": 391.52,
        "duration": 4.239,
        "text": "and 23 and also specify the data frame"
      },
      {
        "start": 395.039,
        "duration": 3.841,
        "text": "schema"
      },
      {
        "start": 395.759,
        "duration": 5.361,
        "text": "with fields user id and age"
      },
      {
        "start": 398.88,
        "duration": 3.36,
        "text": "in addition we add another column for"
      },
      {
        "start": 401.12,
        "duration": 3.44,
        "text": "label with"
      },
      {
        "start": 402.24,
        "duration": 3.12,
        "text": "value user you can see the resulting"
      },
      {
        "start": 404.56,
        "duration": 3.6,
        "text": "data frame"
      },
      {
        "start": 405.36,
        "duration": 3.52,
        "text": "in the output notice that we do not have"
      },
      {
        "start": 408.16,
        "duration": 3.36,
        "text": "a column"
      },
      {
        "start": 408.88,
        "duration": 3.759,
        "text": "for user gender because we do not need"
      },
      {
        "start": 411.52,
        "duration": 3.28,
        "text": "to update it"
      },
      {
        "start": 412.639,
        "duration": 4.321,
        "text": "let's also change the movie rating from"
      },
      {
        "start": 414.8,
        "duration": 4.56,
        "text": "8 to 5 for one of the movies"
      },
      {
        "start": 416.96,
        "duration": 3.12,
        "text": "this time instead of creating a data"
      },
      {
        "start": 419.36,
        "duration": 2.959,
        "text": "frame"
      },
      {
        "start": 420.08,
        "duration": 3.36,
        "text": "with the edge information manually we"
      },
      {
        "start": 422.319,
        "duration": 3.681,
        "text": "can retrieve it"
      },
      {
        "start": 423.44,
        "duration": 4.0,
        "text": "from the graph itself we access edges"
      },
      {
        "start": 426.0,
        "duration": 4.16,
        "text": "through the dsc graph frame"
      },
      {
        "start": 427.44,
        "duration": 4.72,
        "text": "and filter them to have specific source"
      },
      {
        "start": 430.16,
        "duration": 4.159,
        "text": "and destination vertex ids"
      },
      {
        "start": 432.16,
        "duration": 4.0,
        "text": "then we select data frame columns that"
      },
      {
        "start": 434.319,
        "duration": 4.801,
        "text": "we need to identify an"
      },
      {
        "start": 436.16,
        "duration": 4.64,
        "text": "edge and add the rating column with a"
      },
      {
        "start": 439.12,
        "duration": 4.72,
        "text": "new value of 5"
      },
      {
        "start": 440.8,
        "duration": 6.08,
        "text": "that we are updating the update ages"
      },
      {
        "start": 443.84,
        "duration": 6.24,
        "text": "method does the rest of the work for us"
      },
      {
        "start": 446.88,
        "duration": 5.759,
        "text": "we are done with insertions and updates"
      },
      {
        "start": 450.08,
        "duration": 3.36,
        "text": "what about deletions here is how we can"
      },
      {
        "start": 452.639,
        "duration": 3.921,
        "text": "delete"
      },
      {
        "start": 453.44,
        "duration": 6.479,
        "text": "all rated edges with rating 5"
      },
      {
        "start": 456.56,
        "duration": 6.0,
        "text": "and all movie vertices with title"
      },
      {
        "start": 459.919,
        "duration": 4.4,
        "text": "beauty and the beast that should leave"
      },
      {
        "start": 462.56,
        "duration": 4.319,
        "text": "us with one user vertex"
      },
      {
        "start": 464.319,
        "duration": 3.041,
        "text": "one movie vertex and the edge between"
      },
      {
        "start": 466.879,
        "duration": 3.201,
        "text": "them"
      },
      {
        "start": 467.36,
        "duration": 5.119,
        "text": "as shown in this illustration finally"
      },
      {
        "start": 470.08,
        "duration": 5.519,
        "text": "our last example shows how to delete"
      },
      {
        "start": 472.479,
        "duration": 6.0,
        "text": "vertex and edge properties using methods"
      },
      {
        "start": 475.599,
        "duration": 3.921,
        "text": "delete vertex properties and delete edge"
      },
      {
        "start": 478.479,
        "duration": 2.641,
        "text": "properties"
      },
      {
        "start": 479.52,
        "duration": 3.679,
        "text": "we delete country and duration"
      },
      {
        "start": 481.12,
        "duration": 4.639,
        "text": "properties of them on a movie"
      },
      {
        "start": 483.199,
        "duration": 3.361,
        "text": "and the radiant property of all rated"
      },
      {
        "start": 485.759,
        "duration": 3.44,
        "text": "edges"
      },
      {
        "start": 486.56,
        "duration": 3.6,
        "text": "looks very straightforward to me in this"
      },
      {
        "start": 489.199,
        "duration": 3.84,
        "text": "exercise"
      },
      {
        "start": 490.16,
        "duration": 3.439,
        "text": "you will bulk load data from csv files"
      },
      {
        "start": 493.039,
        "duration": 3.041,
        "text": "into"
      },
      {
        "start": 493.599,
        "duration": 3.681,
        "text": "the killer video graph this is a pretty"
      },
      {
        "start": 496.08,
        "duration": 6.799,
        "text": "common scenario"
      },
      {
        "start": 497.28,
        "duration": 5.599,
        "text": "let's do it"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-15T23:00:43.081845+00:00"
}