{
  "video_id": "mtgJJ9E33_Y",
  "title": "DS310.20 Filter Query | DataStax Enterprise 6 Search",
  "description": "#DataStaxAcademy #DS310\nDS310.20 Filter Query\nIn this section we will learn another powerful feature. The filter query parameter filters search results, just like the Q parameter does, but it also keeps its results in a cache which can be re-used by other searches that have the same filter query criteria.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-15T20:52:50Z",
  "thumbnail": "https://i.ytimg.com/vi/mtgJJ9E33_Y/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "search",
    "tutorial",
    "apache_cassandra",
    "query",
    "datastax"
  ],
  "url": "https://www.youtube.com/watch?v=mtgJJ9E33_Y",
  "transcript": {
    "available": true,
    "language": "English (auto-generated)",
    "language_code": "en",
    "is_generated": true,
    "text": "[Music] another powerful feature that we can leverage in search is the filter query the filter query parameter filters search results just like the q parameter does but it also keeps its results in a cache which can be reused by other searches that have the same filter query criteria by applying these cache filters searches that use the filter query parameters can be significantly faster than if you place those same predicates in the queue parameter let's take a look at the mechanics of how a filter query is applied for each fq parameter specified in the search that predicate is executed and its results are stored in the filter cache if that particular predicate has been executed before the step can be skipped and the existing results will be used before the queue parameter is executed the intersection of the various filter query results are taken and used as a starting point for our next search in this case documents 2 9 and 22 are possible candidates the predicate from the q clause can now be executed against our pre-filtered set and in this case our only matching record is document 9. one thing to keep in mind is that predicates specified as part of the filter query are not used in calculating the relevancy of the results that relevancy score is based solely on the predicates from the q parameter if your q parameter is set to a wild card then all of your results will have a constant and therefore meaningless relevancy score as an aside if you specify non-key fields in the cql where clause which is a new feature in dsc6 those fields are evaluated in dsc search using the filter query and therefore won't affect relevancy scores what are some use cases where the filter queries can be useful fields that are commonly searched against and that have low cardinality values are great candidates to be used as filter queries in this example we're searching for stock trades for a given stock symbol and a given user stock symbol has relatively low cardinality values whereas user probably has high cardinality values in other words there might be thousands of distinct stock symbol values but there are potentially millions of users in our data so it's much more likely that a given stock symbol would be searched against multiple times rather than a given user being searched against multiple times here's a case where we're searching for products a common thing you might do in an e-commerce website it's likely that we only want to show products that are in stock so we can add a filter query on the in-stock field the in-stock field is a boolean field which is about as low cardinality as you can get and it certainly qualifies as a commonly searched field in our fictitious example after applying that filter query we get a more relevant set of results and our in-stock products are now cached and available to be used by the next product search filter query and faceting are highly complementary features the same fields that we might normally want to facet on are the same types of fields that we'd want to use in a filter query we can put them together by running a search getting its facets and then letting our users further refine their searches using facet values as the filter query here's an example imagine we search for movies by description and retrieve a list of results we also get facets back based on the film's ratings given this additional context our user realizes that they want to restrict their results to movies with a g rating we can then run a second search using the g ratings as our filter query retrieving those results and their corresponding facets we can continue to apply this technique until the user finds the results they were seeking this is a really powerful combination of tools",
    "segments": [
      {
        "start": 2.11,
        "duration": 3.09,
        "text": "[Music]"
      },
      {
        "start": 3.76,
        "duration": 3.599,
        "text": "another powerful feature that we can"
      },
      {
        "start": 5.2,
        "duration": 3.84,
        "text": "leverage in search is the filter query"
      },
      {
        "start": 7.359,
        "duration": 3.761,
        "text": "the filter query parameter filters"
      },
      {
        "start": 9.04,
        "duration": 2.559,
        "text": "search results just like the q parameter"
      },
      {
        "start": 11.12,
        "duration": 3.28,
        "text": "does"
      },
      {
        "start": 11.599,
        "duration": 4.641,
        "text": "but it also keeps its results in a cache"
      },
      {
        "start": 14.4,
        "duration": 4.08,
        "text": "which can be reused by other searches"
      },
      {
        "start": 16.24,
        "duration": 4.72,
        "text": "that have the same filter query criteria"
      },
      {
        "start": 18.48,
        "duration": 4.559,
        "text": "by applying these cache filters searches"
      },
      {
        "start": 20.96,
        "duration": 3.52,
        "text": "that use the filter query parameters can"
      },
      {
        "start": 23.039,
        "duration": 3.041,
        "text": "be significantly faster"
      },
      {
        "start": 24.48,
        "duration": 3.44,
        "text": "than if you place those same predicates"
      },
      {
        "start": 26.08,
        "duration": 3.599,
        "text": "in the queue parameter let's take a look"
      },
      {
        "start": 27.92,
        "duration": 2.0,
        "text": "at the mechanics of how a filter query"
      },
      {
        "start": 29.679,
        "duration": 2.801,
        "text": "is"
      },
      {
        "start": 29.92,
        "duration": 3.6,
        "text": "applied for each fq parameter specified"
      },
      {
        "start": 32.48,
        "duration": 2.8,
        "text": "in the search"
      },
      {
        "start": 33.52,
        "duration": 3.76,
        "text": "that predicate is executed and its"
      },
      {
        "start": 35.28,
        "duration": 3.36,
        "text": "results are stored in the filter cache"
      },
      {
        "start": 37.28,
        "duration": 4.0,
        "text": "if that particular predicate has been"
      },
      {
        "start": 38.64,
        "duration": 4.64,
        "text": "executed before the step can be skipped"
      },
      {
        "start": 41.28,
        "duration": 4.24,
        "text": "and the existing results will be used"
      },
      {
        "start": 43.28,
        "duration": 4.0,
        "text": "before the queue parameter is executed"
      },
      {
        "start": 45.52,
        "duration": 3.6,
        "text": "the intersection of the various filter"
      },
      {
        "start": 47.28,
        "duration": 3.52,
        "text": "query results are taken"
      },
      {
        "start": 49.12,
        "duration": 3.36,
        "text": "and used as a starting point for our"
      },
      {
        "start": 50.8,
        "duration": 4.56,
        "text": "next search in this case"
      },
      {
        "start": 52.48,
        "duration": 3.599,
        "text": "documents 2 9 and 22 are possible"
      },
      {
        "start": 55.36,
        "duration": 2.56,
        "text": "candidates"
      },
      {
        "start": 56.079,
        "duration": 4.241,
        "text": "the predicate from the q clause can now"
      },
      {
        "start": 57.92,
        "duration": 4.0,
        "text": "be executed against our pre-filtered set"
      },
      {
        "start": 60.32,
        "duration": 3.36,
        "text": "and in this case our only matching"
      },
      {
        "start": 61.92,
        "duration": 3.199,
        "text": "record is document 9."
      },
      {
        "start": 63.68,
        "duration": 3.2,
        "text": "one thing to keep in mind is that"
      },
      {
        "start": 65.119,
        "duration": 4.0,
        "text": "predicates specified as part of the"
      },
      {
        "start": 66.88,
        "duration": 4.239,
        "text": "filter query are not used in calculating"
      },
      {
        "start": 69.119,
        "duration": 4.161,
        "text": "the relevancy of the results"
      },
      {
        "start": 71.119,
        "duration": 4.0,
        "text": "that relevancy score is based solely on"
      },
      {
        "start": 73.28,
        "duration": 3.839,
        "text": "the predicates from the q parameter"
      },
      {
        "start": 75.119,
        "duration": 4.081,
        "text": "if your q parameter is set to a wild"
      },
      {
        "start": 77.119,
        "duration": 2.961,
        "text": "card then all of your results will have"
      },
      {
        "start": 79.2,
        "duration": 2.559,
        "text": "a constant"
      },
      {
        "start": 80.08,
        "duration": 3.6,
        "text": "and therefore meaningless relevancy"
      },
      {
        "start": 81.759,
        "duration": 4.321,
        "text": "score as an aside"
      },
      {
        "start": 83.68,
        "duration": 3.439,
        "text": "if you specify non-key fields in the cql"
      },
      {
        "start": 86.08,
        "duration": 3.76,
        "text": "where clause"
      },
      {
        "start": 87.119,
        "duration": 4.801,
        "text": "which is a new feature in dsc6 those"
      },
      {
        "start": 89.84,
        "duration": 3.919,
        "text": "fields are evaluated in dsc search"
      },
      {
        "start": 91.92,
        "duration": 3.76,
        "text": "using the filter query and therefore"
      },
      {
        "start": 93.759,
        "duration": 3.841,
        "text": "won't affect relevancy scores"
      },
      {
        "start": 95.68,
        "duration": 3.2,
        "text": "what are some use cases where the filter"
      },
      {
        "start": 97.6,
        "duration": 2.559,
        "text": "queries can be useful"
      },
      {
        "start": 98.88,
        "duration": 3.199,
        "text": "fields that are commonly searched"
      },
      {
        "start": 100.159,
        "duration": 3.6,
        "text": "against and that have low cardinality"
      },
      {
        "start": 102.079,
        "duration": 3.04,
        "text": "values are great candidates to be used"
      },
      {
        "start": 103.759,
        "duration": 3.04,
        "text": "as filter queries"
      },
      {
        "start": 105.119,
        "duration": 3.921,
        "text": "in this example we're searching for"
      },
      {
        "start": 106.799,
        "duration": 4.241,
        "text": "stock trades for a given stock symbol"
      },
      {
        "start": 109.04,
        "duration": 4.079,
        "text": "and a given user stock symbol has"
      },
      {
        "start": 111.04,
        "duration": 4.079,
        "text": "relatively low cardinality values"
      },
      {
        "start": 113.119,
        "duration": 3.28,
        "text": "whereas user probably has high"
      },
      {
        "start": 115.119,
        "duration": 2.96,
        "text": "cardinality values"
      },
      {
        "start": 116.399,
        "duration": 3.601,
        "text": "in other words there might be thousands"
      },
      {
        "start": 118.079,
        "duration": 3.761,
        "text": "of distinct stock symbol values but"
      },
      {
        "start": 120.0,
        "duration": 2.56,
        "text": "there are potentially millions of users"
      },
      {
        "start": 121.84,
        "duration": 3.04,
        "text": "in our data"
      },
      {
        "start": 122.56,
        "duration": 3.919,
        "text": "so it's much more likely that a given"
      },
      {
        "start": 124.88,
        "duration": 3.599,
        "text": "stock symbol would be searched against"
      },
      {
        "start": 126.479,
        "duration": 3.92,
        "text": "multiple times rather than a given user"
      },
      {
        "start": 128.479,
        "duration": 3.441,
        "text": "being searched against multiple times"
      },
      {
        "start": 130.399,
        "duration": 3.441,
        "text": "here's a case where we're searching for"
      },
      {
        "start": 131.92,
        "duration": 3.2,
        "text": "products a common thing you might do in"
      },
      {
        "start": 133.84,
        "duration": 2.88,
        "text": "an e-commerce website"
      },
      {
        "start": 135.12,
        "duration": 3.28,
        "text": "it's likely that we only want to show"
      },
      {
        "start": 136.72,
        "duration": 3.28,
        "text": "products that are in stock"
      },
      {
        "start": 138.4,
        "duration": 3.919,
        "text": "so we can add a filter query on the"
      },
      {
        "start": 140.0,
        "duration": 3.92,
        "text": "in-stock field the in-stock field is a"
      },
      {
        "start": 142.319,
        "duration": 3.121,
        "text": "boolean field which is about as low"
      },
      {
        "start": 143.92,
        "duration": 3.36,
        "text": "cardinality as you can get"
      },
      {
        "start": 145.44,
        "duration": 4.24,
        "text": "and it certainly qualifies as a commonly"
      },
      {
        "start": 147.28,
        "duration": 4.48,
        "text": "searched field in our fictitious example"
      },
      {
        "start": 149.68,
        "duration": 3.68,
        "text": "after applying that filter query we get"
      },
      {
        "start": 151.76,
        "duration": 3.759,
        "text": "a more relevant set of results"
      },
      {
        "start": 153.36,
        "duration": 3.84,
        "text": "and our in-stock products are now cached"
      },
      {
        "start": 155.519,
        "duration": 2.8,
        "text": "and available to be used by the next"
      },
      {
        "start": 157.2,
        "duration": 3.039,
        "text": "product search"
      },
      {
        "start": 158.319,
        "duration": 3.681,
        "text": "filter query and faceting are highly"
      },
      {
        "start": 160.239,
        "duration": 3.28,
        "text": "complementary features"
      },
      {
        "start": 162.0,
        "duration": 3.68,
        "text": "the same fields that we might normally"
      },
      {
        "start": 163.519,
        "duration": 3.921,
        "text": "want to facet on are the same types of"
      },
      {
        "start": 165.68,
        "duration": 2.32,
        "text": "fields that we'd want to use in a filter"
      },
      {
        "start": 167.44,
        "duration": 2.079,
        "text": "query"
      },
      {
        "start": 168.0,
        "duration": 3.36,
        "text": "we can put them together by running a"
      },
      {
        "start": 169.519,
        "duration": 3.201,
        "text": "search getting its facets"
      },
      {
        "start": 171.36,
        "duration": 3.76,
        "text": "and then letting our users further"
      },
      {
        "start": 172.72,
        "duration": 3.68,
        "text": "refine their searches using facet values"
      },
      {
        "start": 175.12,
        "duration": 3.44,
        "text": "as the filter query"
      },
      {
        "start": 176.4,
        "duration": 3.68,
        "text": "here's an example imagine we search for"
      },
      {
        "start": 178.56,
        "duration": 3.84,
        "text": "movies by description"
      },
      {
        "start": 180.08,
        "duration": 4.079,
        "text": "and retrieve a list of results we also"
      },
      {
        "start": 182.4,
        "duration": 2.479,
        "text": "get facets back based on the film's"
      },
      {
        "start": 184.159,
        "duration": 2.561,
        "text": "ratings"
      },
      {
        "start": 184.879,
        "duration": 3.28,
        "text": "given this additional context our user"
      },
      {
        "start": 186.72,
        "duration": 3.599,
        "text": "realizes that they want to restrict"
      },
      {
        "start": 188.159,
        "duration": 3.761,
        "text": "their results to movies with a g rating"
      },
      {
        "start": 190.319,
        "duration": 3.761,
        "text": "we can then run a second search using"
      },
      {
        "start": 191.92,
        "duration": 3.599,
        "text": "the g ratings as our filter query"
      },
      {
        "start": 194.08,
        "duration": 3.68,
        "text": "retrieving those results and their"
      },
      {
        "start": 195.519,
        "duration": 3.761,
        "text": "corresponding facets we can continue to"
      },
      {
        "start": 197.76,
        "duration": 3.68,
        "text": "apply this technique until the user"
      },
      {
        "start": 199.28,
        "duration": 5.84,
        "text": "finds the results they were seeking"
      },
      {
        "start": 201.44,
        "duration": 3.68,
        "text": "this is a really powerful combination of"
      },
      {
        "start": 206.28,
        "duration": 3.0,
        "text": "tools"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-16T00:13:49.442998+00:00"
}