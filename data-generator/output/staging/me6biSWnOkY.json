{
  "video_id": "me6biSWnOkY",
  "title": "DS210.32 Tuning the Kernel | Operations with Apache Cassandra",
  "description": "#DataStaxAcademy #DS210\nDS210.32 TUNING THE KERNEL\nIn this unit, we discuss the important aspects of kernel configuration to get the best performance out of your Apache Cassandra or DataStax Enterprise nodes.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-12T01:51:36Z",
  "thumbnail": "https://i.ytimg.com/vi/me6biSWnOkY/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "tutorial",
    "apache_cassandra",
    "performance",
    "datastax"
  ],
  "url": "https://www.youtube.com/watch?v=me6biSWnOkY",
  "transcript": {
    "available": true,
    "language": "English (auto-generated)",
    "language_code": "en",
    "is_generated": true,
    "text": "[Music] as you know by now timestamps are important to apache cassandra to be able to identify the most recent data but in a completely distributed system like apache cassandra keeping all the nodes in sync is a little challenging each node has its own timestamp counter that keeps track of the node local time it's not enough to synchronize these timestamp counters once because these counters will drift apart over time so it is necessary to resynchronize the node clocks periodically network time protocol or ntp performs the synchronization for us generally this happens without any intervention but you might be aware of this mechanism general purpose operating systems like linux have resource limits to prevent a user from hogging all the resources you investigate these limits using the you limit command for nodes running apache cassandra we do want to let cassandra processes have unfettered access to all resources on the machine we can turn off these limits by adding the limits conf file notice that if you're running on ubuntu system you will want to use root instead of star for general purpose linux systems it might make sense to allow swapping as a way to increase the size of virtual memory however for apache cassandra swapping will have a devastating impact you're actually better off letting your node die and restart rather than limp long swapping memory so we want to disable swapping completely let me show you how we do this you can turn off swapping without rebooting using the swap off dash a command this makes changes in the running image but it doesn't turn off swap permanently you can permanently disable swap devices after reboot by editing the fstab file here's the set script that will make the necessary changes the swappiness setting tells the kernel how aggressively to swap pages to disk a low value tells the kernel not to swap pages so in etsy syscontrol set vm swappiness to zero as shown at the bottom of the slide you may also want to change your kernel network settings you set these in the etsy syscontrolconf as shown on the slide once you edit the etsy syscontrolconf you can reload the values using the syscontrol-p command we're not going into an explanation of each of these values in this class but check your man pages for the complete description",
    "segments": [
      {
        "start": 1.43,
        "duration": 5.33,
        "text": "[Music]"
      },
      {
        "start": 7.04,
        "duration": 3.04,
        "text": "as you know by now"
      },
      {
        "start": 8.24,
        "duration": 4.16,
        "text": "timestamps are important to apache"
      },
      {
        "start": 10.08,
        "duration": 2.8,
        "text": "cassandra to be able to identify the"
      },
      {
        "start": 12.4,
        "duration": 2.72,
        "text": "most"
      },
      {
        "start": 12.88,
        "duration": 3.6,
        "text": "recent data but in a completely"
      },
      {
        "start": 15.12,
        "duration": 4.319,
        "text": "distributed system like"
      },
      {
        "start": 16.48,
        "duration": 4.959,
        "text": "apache cassandra keeping all the nodes"
      },
      {
        "start": 19.439,
        "duration": 4.881,
        "text": "in sync is a little challenging"
      },
      {
        "start": 21.439,
        "duration": 5.68,
        "text": "each node has its own timestamp counter"
      },
      {
        "start": 24.32,
        "duration": 4.56,
        "text": "that keeps track of the node local time"
      },
      {
        "start": 27.119,
        "duration": 3.681,
        "text": "it's not enough to synchronize these"
      },
      {
        "start": 28.88,
        "duration": 3.839,
        "text": "timestamp counters once"
      },
      {
        "start": 30.8,
        "duration": 4.24,
        "text": "because these counters will drift apart"
      },
      {
        "start": 32.719,
        "duration": 3.84,
        "text": "over time so it is necessary to"
      },
      {
        "start": 35.04,
        "duration": 2.64,
        "text": "resynchronize the node clocks"
      },
      {
        "start": 36.559,
        "duration": 4.561,
        "text": "periodically"
      },
      {
        "start": 37.68,
        "duration": 5.76,
        "text": "network time protocol or ntp performs"
      },
      {
        "start": 41.12,
        "duration": 4.16,
        "text": "the synchronization for us"
      },
      {
        "start": 43.44,
        "duration": 3.04,
        "text": "generally this happens without any"
      },
      {
        "start": 45.28,
        "duration": 4.16,
        "text": "intervention"
      },
      {
        "start": 46.48,
        "duration": 5.04,
        "text": "but you might be aware of this mechanism"
      },
      {
        "start": 49.44,
        "duration": 4.4,
        "text": "general purpose operating systems like"
      },
      {
        "start": 51.52,
        "duration": 5.28,
        "text": "linux have resource limits to prevent a"
      },
      {
        "start": 53.84,
        "duration": 4.879,
        "text": "user from hogging all the resources"
      },
      {
        "start": 56.8,
        "duration": 3.439,
        "text": "you investigate these limits using the"
      },
      {
        "start": 58.719,
        "duration": 4.081,
        "text": "you limit command"
      },
      {
        "start": 60.239,
        "duration": 4.64,
        "text": "for nodes running apache cassandra we do"
      },
      {
        "start": 62.8,
        "duration": 4.88,
        "text": "want to let cassandra processes have"
      },
      {
        "start": 64.879,
        "duration": 3.92,
        "text": "unfettered access to all resources on"
      },
      {
        "start": 67.68,
        "duration": 3.04,
        "text": "the machine"
      },
      {
        "start": 68.799,
        "duration": 3.121,
        "text": "we can turn off these limits by adding"
      },
      {
        "start": 70.72,
        "duration": 4.0,
        "text": "the limits conf"
      },
      {
        "start": 71.92,
        "duration": 4.239,
        "text": "file notice that if you're running on"
      },
      {
        "start": 74.72,
        "duration": 3.6,
        "text": "ubuntu system"
      },
      {
        "start": 76.159,
        "duration": 3.28,
        "text": "you will want to use root instead of"
      },
      {
        "start": 78.32,
        "duration": 3.52,
        "text": "star"
      },
      {
        "start": 79.439,
        "duration": 4.561,
        "text": "for general purpose linux systems it"
      },
      {
        "start": 81.84,
        "duration": 4.16,
        "text": "might make sense to allow swapping as a"
      },
      {
        "start": 84.0,
        "duration": 4.72,
        "text": "way to increase the size of virtual"
      },
      {
        "start": 86.0,
        "duration": 5.36,
        "text": "memory however for apache cassandra"
      },
      {
        "start": 88.72,
        "duration": 4.399,
        "text": "swapping will have a devastating impact"
      },
      {
        "start": 91.36,
        "duration": 4.48,
        "text": "you're actually better off letting your"
      },
      {
        "start": 93.119,
        "duration": 3.201,
        "text": "node die and restart rather than limp"
      },
      {
        "start": 95.84,
        "duration": 3.279,
        "text": "long"
      },
      {
        "start": 96.32,
        "duration": 4.159,
        "text": "swapping memory so we want to disable"
      },
      {
        "start": 99.119,
        "duration": 3.441,
        "text": "swapping completely"
      },
      {
        "start": 100.479,
        "duration": 4.161,
        "text": "let me show you how we do this you can"
      },
      {
        "start": 102.56,
        "duration": 4.96,
        "text": "turn off swapping without rebooting"
      },
      {
        "start": 104.64,
        "duration": 4.88,
        "text": "using the swap off dash a command this"
      },
      {
        "start": 107.52,
        "duration": 4.639,
        "text": "makes changes in the running image but"
      },
      {
        "start": 109.52,
        "duration": 5.52,
        "text": "it doesn't turn off swap permanently"
      },
      {
        "start": 112.159,
        "duration": 4.081,
        "text": "you can permanently disable swap devices"
      },
      {
        "start": 115.04,
        "duration": 4.8,
        "text": "after reboot"
      },
      {
        "start": 116.24,
        "duration": 5.12,
        "text": "by editing the fstab file here's the set"
      },
      {
        "start": 119.84,
        "duration": 3.76,
        "text": "script that will make the necessary"
      },
      {
        "start": 121.36,
        "duration": 4.16,
        "text": "changes"
      },
      {
        "start": 123.6,
        "duration": 4.719,
        "text": "the swappiness setting tells the kernel"
      },
      {
        "start": 125.52,
        "duration": 5.2,
        "text": "how aggressively to swap pages to disk"
      },
      {
        "start": 128.319,
        "duration": 3.201,
        "text": "a low value tells the kernel not to swap"
      },
      {
        "start": 130.72,
        "duration": 4.0,
        "text": "pages"
      },
      {
        "start": 131.52,
        "duration": 5.6,
        "text": "so in etsy syscontrol set"
      },
      {
        "start": 134.72,
        "duration": 4.239,
        "text": "vm swappiness to zero as shown at the"
      },
      {
        "start": 137.12,
        "duration": 3.92,
        "text": "bottom of the slide"
      },
      {
        "start": 138.959,
        "duration": 3.28,
        "text": "you may also want to change your kernel"
      },
      {
        "start": 141.04,
        "duration": 3.68,
        "text": "network settings"
      },
      {
        "start": 142.239,
        "duration": 4.0,
        "text": "you set these in the etsy syscontrolconf"
      },
      {
        "start": 144.72,
        "duration": 4.159,
        "text": "as shown on the slide"
      },
      {
        "start": 146.239,
        "duration": 4.841,
        "text": "once you edit the etsy syscontrolconf"
      },
      {
        "start": 148.879,
        "duration": 3.36,
        "text": "you can reload the values using the"
      },
      {
        "start": 151.08,
        "duration": 3.32,
        "text": "syscontrol-p"
      },
      {
        "start": 152.239,
        "duration": 3.921,
        "text": "command we're not going into an"
      },
      {
        "start": 154.4,
        "duration": 2.64,
        "text": "explanation of each of these values in"
      },
      {
        "start": 156.16,
        "duration": 2.32,
        "text": "this class"
      },
      {
        "start": 157.04,
        "duration": 7.68,
        "text": "but check your man pages for the"
      },
      {
        "start": 158.48,
        "duration": 6.24,
        "text": "complete description"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-16T01:13:17.017965+00:00"
}