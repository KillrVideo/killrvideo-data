{
  "video_id": "ISJY1vyOABo",
  "title": "DS210.13 Removing a Node | Operations with Apache Cassandra",
  "description": "#DataStaxAcademy #DS210\nDS210.13 REMOVING A NODE\nWhen would you ever need to remove a node from a running Apache Cassandra cluster? In this unit, we dicuss why and how you would go about it.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-11T12:27:09Z",
  "thumbnail": "https://i.ytimg.com/vi/ISJY1vyOABo/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "datastax",
    "tutorial",
    "apache_cassandra"
  ],
  "url": "https://www.youtube.com/watch?v=ISJY1vyOABo",
  "transcript": {
    "available": true,
    "language": "English (auto-generated)",
    "language_code": "en",
    "is_generated": true,
    "text": "[Music] let's talk about removing a node from a running cassandra cluster when would you ever need to do that well there are cases in those cases but you may want to reduce your capacity maybe you ramped up your capacity for some event and now you need to bring it back down again perfectly legitimate and that's actually a good use case for this the more likely case is that you have a node that is just behaving poorly it's been bad it needs a timeout get it out of the ring and that is a situation which more of a corrective where we need to get rid of it and bring back a new one so decommission and reboot strap that's a process you may need to do often with a running cassandra cluster depending on hardware failures things like that so how do we do this so when you remove a node from running cluster what happens is the rest of the cluster needs to make up for that loss that's a certain amount of capacity that you're losing so in this case where we have a four node ring we just lost one quarter of our capacity by decommissioning it and when you do that that data needs to stream back out to the other nodes those nodes need to have that information so there's some operation that has to happen just in decommissioning not just turn off the node and go away when the node decommissions it has to go through some activity so they're very simple commands and these are commands that if you type them for the wrong reason you're going to be sorry but just know what they are no tool decommission this sets up that activity where it actually starts streaming data away from the node getting it ready to be removed that data that's stored there needs to go out consistency checked and then it's ready to go offline so when you use the nodetool remove node command very similar but this is a command you run if the node that you want it offline is already there let's say that you lost a node from a severe hardware failure and you need to remove that node from the cluster topology information so you go to another running node run the remove node for the node that's gone and it will use the replicas to redistribute the data this is how you do it in an emergency situation so the big difference here is decommission i have the node i want to decommission online and then the remove node is i don't have the node anymore it's offline it's gone don't ask here's your data so very similar but very different in the problems that you're solving finally there's the worst command i've ever heard of but it's true no tool assassinate so what that means is i have a node that just won't go away this is like doing a kill-9 on your cluster for that running node somewhere so you want it gone you want it out you just don't want it in your cluster topology information anymore nothing you're doing like a remove node will get rid of it no tool assassinate just removes it from the system tables it doesn't exist anymore it's dead to the cluster this is the last chance resort you have please use this sparingly so decommissioning a note let's walk through what that does so decommission if you want to decrease the size of your cluster again like you ramped up maybe and now you want to bring it back down so when you run decommission that node data will get distributed pretty evenly amongst the other nodes because you're redistributing the token load across all the running nodes so the token ranges are now increasing on every single node after you run the decommission command it goes through a series of actions not just streaming data but it also goes through the shutting down of the ports and actually shutting down that running node so it goes through all the processes that data is not deleted from the node it's still sitting there so if you need it for later that's still there but just know that it is going to shut it down completely and disappear from the cluster information the command pretty simple no tool decommission and there are some other commands if you have to run it from another node but in this case you probably should run it from the node you want to decommission remove node again pretty bad situation maybe something hardware failure it died that's okay you need to do that it happens this is actually pretty prevalent in say a cloud situation where maybe inadvertently you took out the node and you can't bring it back if you kill a virtual machine or a instance in a cloud you can't get that back it's not coming back so in that case you're going to have to do a remove node on one of the running nodes and this is the next level of escalation of getting rid of a node the command is pretty simple and you can even ask for a status of how things are going back to assassinate again last resort do not run this unless you absolutely have to and it's there for a reason sometimes the state of the cluster gets a little wacky and you need to use this command to remove it from all the system tables but again if you're using this you really need to think twice before hitting that command because what you're doing is you're just forcing a node out of the cluster really hard and it may not be the best situation if you do think you have a running node in there it will cause some weird instability if that data really was supposed to be there the command is pretty simple you say no tool assassinate put in the ip address of that node you want to get rid of and it's gone this has been a pretty good overview of how to remove nodes in all different situations from good to bad and if you have a situation where you need to remove a node use one of these techniques you",
    "segments": [
      {
        "start": 1.43,
        "duration": 8.089,
        "text": "[Music]"
      },
      {
        "start": 7.44,
        "duration": 4.239,
        "text": "let's talk about removing a node"
      },
      {
        "start": 9.519,
        "duration": 3.921,
        "text": "from a running cassandra cluster when"
      },
      {
        "start": 11.679,
        "duration": 4.481,
        "text": "would you ever need to do that"
      },
      {
        "start": 13.44,
        "duration": 4.64,
        "text": "well there are cases in those cases but"
      },
      {
        "start": 16.16,
        "duration": 3.68,
        "text": "you may want to reduce your capacity"
      },
      {
        "start": 18.08,
        "duration": 3.68,
        "text": "maybe you ramped up your capacity for"
      },
      {
        "start": 19.84,
        "duration": 2.8,
        "text": "some event and now you need to bring it"
      },
      {
        "start": 21.76,
        "duration": 2.72,
        "text": "back down again"
      },
      {
        "start": 22.64,
        "duration": 3.68,
        "text": "perfectly legitimate and that's actually"
      },
      {
        "start": 24.48,
        "duration": 4.0,
        "text": "a good use case for this"
      },
      {
        "start": 26.32,
        "duration": 3.92,
        "text": "the more likely case is that you have a"
      },
      {
        "start": 28.48,
        "duration": 4.72,
        "text": "node that is just behaving"
      },
      {
        "start": 30.24,
        "duration": 4.319,
        "text": "poorly it's been bad it needs a timeout"
      },
      {
        "start": 33.2,
        "duration": 3.359,
        "text": "get it out of the ring"
      },
      {
        "start": 34.559,
        "duration": 4.16,
        "text": "and that is a situation which more of a"
      },
      {
        "start": 36.559,
        "duration": 4.0,
        "text": "corrective where we need to get rid of"
      },
      {
        "start": 38.719,
        "duration": 4.801,
        "text": "it and bring back a new one so"
      },
      {
        "start": 40.559,
        "duration": 4.32,
        "text": "decommission and reboot strap that's a"
      },
      {
        "start": 43.52,
        "duration": 3.44,
        "text": "process you may need to do"
      },
      {
        "start": 44.879,
        "duration": 3.041,
        "text": "often with a running cassandra cluster"
      },
      {
        "start": 46.96,
        "duration": 3.279,
        "text": "depending on"
      },
      {
        "start": 47.92,
        "duration": 3.76,
        "text": "hardware failures things like that so"
      },
      {
        "start": 50.239,
        "duration": 3.681,
        "text": "how do we do this"
      },
      {
        "start": 51.68,
        "duration": 3.12,
        "text": "so when you remove a node from running"
      },
      {
        "start": 53.92,
        "duration": 2.479,
        "text": "cluster"
      },
      {
        "start": 54.8,
        "duration": 4.0,
        "text": "what happens is the rest of the cluster"
      },
      {
        "start": 56.399,
        "duration": 4.561,
        "text": "needs to make up for that loss"
      },
      {
        "start": 58.8,
        "duration": 3.12,
        "text": "that's a certain amount of capacity that"
      },
      {
        "start": 60.96,
        "duration": 3.04,
        "text": "you're losing"
      },
      {
        "start": 61.92,
        "duration": 3.199,
        "text": "so in this case where we have a four"
      },
      {
        "start": 64.0,
        "duration": 3.76,
        "text": "node ring"
      },
      {
        "start": 65.119,
        "duration": 4.0,
        "text": "we just lost one quarter of our capacity"
      },
      {
        "start": 67.76,
        "duration": 3.679,
        "text": "by decommissioning it"
      },
      {
        "start": 69.119,
        "duration": 3.121,
        "text": "and when you do that that data needs to"
      },
      {
        "start": 71.439,
        "duration": 3.04,
        "text": "stream back"
      },
      {
        "start": 72.24,
        "duration": 3.919,
        "text": "out to the other nodes those nodes need"
      },
      {
        "start": 74.479,
        "duration": 3.361,
        "text": "to have that information so there's some"
      },
      {
        "start": 76.159,
        "duration": 3.041,
        "text": "operation that has to happen just in"
      },
      {
        "start": 77.84,
        "duration": 3.52,
        "text": "decommissioning not just"
      },
      {
        "start": 79.2,
        "duration": 4.08,
        "text": "turn off the node and go away when the"
      },
      {
        "start": 81.36,
        "duration": 2.64,
        "text": "node decommissions it has to go through"
      },
      {
        "start": 83.28,
        "duration": 3.519,
        "text": "some"
      },
      {
        "start": 84.0,
        "duration": 4.32,
        "text": "activity so they're very simple commands"
      },
      {
        "start": 86.799,
        "duration": 1.841,
        "text": "and these are commands that if you type"
      },
      {
        "start": 88.32,
        "duration": 2.24,
        "text": "them"
      },
      {
        "start": 88.64,
        "duration": 4.0,
        "text": "for the wrong reason you're going to be"
      },
      {
        "start": 90.56,
        "duration": 4.4,
        "text": "sorry but just know what they are"
      },
      {
        "start": 92.64,
        "duration": 3.04,
        "text": "no tool decommission this sets up that"
      },
      {
        "start": 94.96,
        "duration": 2.4,
        "text": "activity"
      },
      {
        "start": 95.68,
        "duration": 3.04,
        "text": "where it actually starts streaming data"
      },
      {
        "start": 97.36,
        "duration": 4.0,
        "text": "away from the node"
      },
      {
        "start": 98.72,
        "duration": 3.6,
        "text": "getting it ready to be removed that data"
      },
      {
        "start": 101.36,
        "duration": 3.84,
        "text": "that's stored there"
      },
      {
        "start": 102.32,
        "duration": 4.88,
        "text": "needs to go out consistency checked and"
      },
      {
        "start": 105.2,
        "duration": 4.48,
        "text": "then it's ready to go offline"
      },
      {
        "start": 107.2,
        "duration": 3.36,
        "text": "so when you use the nodetool remove node"
      },
      {
        "start": 109.68,
        "duration": 3.119,
        "text": "command"
      },
      {
        "start": 110.56,
        "duration": 5.12,
        "text": "very similar but this is a command you"
      },
      {
        "start": 112.799,
        "duration": 5.041,
        "text": "run if the node that you want it offline"
      },
      {
        "start": 115.68,
        "duration": 4.24,
        "text": "is already there let's say that you lost"
      },
      {
        "start": 117.84,
        "duration": 3.919,
        "text": "a node from a severe hardware failure"
      },
      {
        "start": 119.92,
        "duration": 4.159,
        "text": "and you need to remove that node from"
      },
      {
        "start": 121.759,
        "duration": 4.881,
        "text": "the cluster topology information"
      },
      {
        "start": 124.079,
        "duration": 5.281,
        "text": "so you go to another running node run"
      },
      {
        "start": 126.64,
        "duration": 4.319,
        "text": "the remove node for the node that's gone"
      },
      {
        "start": 129.36,
        "duration": 3.04,
        "text": "and it will use the replicas to"
      },
      {
        "start": 130.959,
        "duration": 3.521,
        "text": "redistribute the data"
      },
      {
        "start": 132.4,
        "duration": 4.0,
        "text": "this is how you do it in an emergency"
      },
      {
        "start": 134.48,
        "duration": 2.72,
        "text": "situation so the big difference here is"
      },
      {
        "start": 136.4,
        "duration": 2.96,
        "text": "decommission"
      },
      {
        "start": 137.2,
        "duration": 3.119,
        "text": "i have the node i want to decommission"
      },
      {
        "start": 139.36,
        "duration": 3.84,
        "text": "online"
      },
      {
        "start": 140.319,
        "duration": 5.041,
        "text": "and then the remove node is i don't have"
      },
      {
        "start": 143.2,
        "duration": 5.2,
        "text": "the node anymore it's offline it's gone"
      },
      {
        "start": 145.36,
        "duration": 4.64,
        "text": "don't ask here's your data so very"
      },
      {
        "start": 148.4,
        "duration": 4.24,
        "text": "similar but very different in"
      },
      {
        "start": 150.0,
        "duration": 3.84,
        "text": "the problems that you're solving finally"
      },
      {
        "start": 152.64,
        "duration": 4.16,
        "text": "there's the worst command"
      },
      {
        "start": 153.84,
        "duration": 4.32,
        "text": "i've ever heard of but it's true no tool"
      },
      {
        "start": 156.8,
        "duration": 3.68,
        "text": "assassinate"
      },
      {
        "start": 158.16,
        "duration": 3.52,
        "text": "so what that means is i have a node that"
      },
      {
        "start": 160.48,
        "duration": 3.839,
        "text": "just won't go away"
      },
      {
        "start": 161.68,
        "duration": 4.96,
        "text": "this is like doing a kill-9 on your"
      },
      {
        "start": 164.319,
        "duration": 4.401,
        "text": "cluster for that running node somewhere"
      },
      {
        "start": 166.64,
        "duration": 3.2,
        "text": "so you want it gone you want it out you"
      },
      {
        "start": 168.72,
        "duration": 3.04,
        "text": "just don't want it in your cluster"
      },
      {
        "start": 169.84,
        "duration": 3.52,
        "text": "topology information anymore"
      },
      {
        "start": 171.76,
        "duration": 3.6,
        "text": "nothing you're doing like a remove node"
      },
      {
        "start": 173.36,
        "duration": 3.04,
        "text": "will get rid of it no tool assassinate"
      },
      {
        "start": 175.36,
        "duration": 3.28,
        "text": "just removes it"
      },
      {
        "start": 176.4,
        "duration": 4.32,
        "text": "from the system tables it doesn't exist"
      },
      {
        "start": 178.64,
        "duration": 4.879,
        "text": "anymore it's dead to the cluster"
      },
      {
        "start": 180.72,
        "duration": 5.28,
        "text": "this is the last chance resort you have"
      },
      {
        "start": 183.519,
        "duration": 4.161,
        "text": "please use this sparingly"
      },
      {
        "start": 186.0,
        "duration": 3.12,
        "text": "so decommissioning a note let's walk"
      },
      {
        "start": 187.68,
        "duration": 3.44,
        "text": "through what that does"
      },
      {
        "start": 189.12,
        "duration": 3.839,
        "text": "so decommission if you want to decrease"
      },
      {
        "start": 191.12,
        "duration": 2.96,
        "text": "the size of your cluster again like you"
      },
      {
        "start": 192.959,
        "duration": 3.041,
        "text": "ramped up maybe"
      },
      {
        "start": 194.08,
        "duration": 3.76,
        "text": "and now you want to bring it back down"
      },
      {
        "start": 196.0,
        "duration": 3.68,
        "text": "so when you run decommission"
      },
      {
        "start": 197.84,
        "duration": 3.84,
        "text": "that node data will get distributed"
      },
      {
        "start": 199.68,
        "duration": 3.919,
        "text": "pretty evenly amongst the other nodes"
      },
      {
        "start": 201.68,
        "duration": 2.479,
        "text": "because you're redistributing the token"
      },
      {
        "start": 203.599,
        "duration": 2.56,
        "text": "load"
      },
      {
        "start": 204.159,
        "duration": 3.201,
        "text": "across all the running nodes so the"
      },
      {
        "start": 206.159,
        "duration": 3.761,
        "text": "token ranges are now"
      },
      {
        "start": 207.36,
        "duration": 4.159,
        "text": "increasing on every single node after"
      },
      {
        "start": 209.92,
        "duration": 3.28,
        "text": "you run the decommission command"
      },
      {
        "start": 211.519,
        "duration": 3.121,
        "text": "it goes through a series of actions not"
      },
      {
        "start": 213.2,
        "duration": 3.36,
        "text": "just streaming data"
      },
      {
        "start": 214.64,
        "duration": 3.2,
        "text": "but it also goes through the shutting"
      },
      {
        "start": 216.56,
        "duration": 3.039,
        "text": "down of the ports"
      },
      {
        "start": 217.84,
        "duration": 3.84,
        "text": "and actually shutting down that running"
      },
      {
        "start": 219.599,
        "duration": 3.2,
        "text": "node so it goes through all the"
      },
      {
        "start": 221.68,
        "duration": 3.279,
        "text": "processes"
      },
      {
        "start": 222.799,
        "duration": 3.36,
        "text": "that data is not deleted from the node"
      },
      {
        "start": 224.959,
        "duration": 2.961,
        "text": "it's still sitting there"
      },
      {
        "start": 226.159,
        "duration": 4.08,
        "text": "so if you need it for later that's still"
      },
      {
        "start": 227.92,
        "duration": 4.319,
        "text": "there but just know that it is going to"
      },
      {
        "start": 230.239,
        "duration": 4.64,
        "text": "shut it down completely and disappear"
      },
      {
        "start": 232.239,
        "duration": 3.601,
        "text": "from the cluster information the command"
      },
      {
        "start": 234.879,
        "duration": 3.521,
        "text": "pretty simple"
      },
      {
        "start": 235.84,
        "duration": 3.759,
        "text": "no tool decommission and there are some"
      },
      {
        "start": 238.4,
        "duration": 2.559,
        "text": "other commands if you have to run it"
      },
      {
        "start": 239.599,
        "duration": 3.441,
        "text": "from another node"
      },
      {
        "start": 240.959,
        "duration": 3.121,
        "text": "but in this case you probably should run"
      },
      {
        "start": 243.04,
        "duration": 2.399,
        "text": "it from the node you want to"
      },
      {
        "start": 244.08,
        "duration": 4.079,
        "text": "decommission"
      },
      {
        "start": 245.439,
        "duration": 3.681,
        "text": "remove node again pretty bad situation"
      },
      {
        "start": 248.159,
        "duration": 4.321,
        "text": "maybe something"
      },
      {
        "start": 249.12,
        "duration": 5.44,
        "text": "hardware failure it died that's okay you"
      },
      {
        "start": 252.48,
        "duration": 3.84,
        "text": "need to do that it happens this is"
      },
      {
        "start": 254.56,
        "duration": 4.079,
        "text": "actually pretty prevalent in say"
      },
      {
        "start": 256.32,
        "duration": 3.36,
        "text": "a cloud situation where maybe"
      },
      {
        "start": 258.639,
        "duration": 4.161,
        "text": "inadvertently"
      },
      {
        "start": 259.68,
        "duration": 4.079,
        "text": "you took out the node and you can't"
      },
      {
        "start": 262.8,
        "duration": 3.679,
        "text": "bring it back"
      },
      {
        "start": 263.759,
        "duration": 3.44,
        "text": "if you kill a virtual machine or a"
      },
      {
        "start": 266.479,
        "duration": 3.201,
        "text": "instance"
      },
      {
        "start": 267.199,
        "duration": 3.28,
        "text": "in a cloud you can't get that back it's"
      },
      {
        "start": 269.68,
        "duration": 2.48,
        "text": "not coming back"
      },
      {
        "start": 270.479,
        "duration": 3.521,
        "text": "so in that case you're going to have to"
      },
      {
        "start": 272.16,
        "duration": 5.039,
        "text": "do a remove node on one of the running"
      },
      {
        "start": 274.0,
        "duration": 5.36,
        "text": "nodes and this is the next level of"
      },
      {
        "start": 277.199,
        "duration": 4.641,
        "text": "escalation of getting rid of a node"
      },
      {
        "start": 279.36,
        "duration": 4.24,
        "text": "the command is pretty simple and you can"
      },
      {
        "start": 281.84,
        "duration": 3.12,
        "text": "even ask for a status of how things are"
      },
      {
        "start": 283.6,
        "duration": 4.879,
        "text": "going"
      },
      {
        "start": 284.96,
        "duration": 5.36,
        "text": "back to assassinate again last resort"
      },
      {
        "start": 288.479,
        "duration": 3.44,
        "text": "do not run this unless you absolutely"
      },
      {
        "start": 290.32,
        "duration": 3.52,
        "text": "have to and"
      },
      {
        "start": 291.919,
        "duration": 4.0,
        "text": "it's there for a reason sometimes the"
      },
      {
        "start": 293.84,
        "duration": 3.52,
        "text": "state of the cluster gets a little wacky"
      },
      {
        "start": 295.919,
        "duration": 3.521,
        "text": "and you need to use this command to"
      },
      {
        "start": 297.36,
        "duration": 4.399,
        "text": "remove it from all the system tables"
      },
      {
        "start": 299.44,
        "duration": 3.68,
        "text": "but again if you're using this you"
      },
      {
        "start": 301.759,
        "duration": 2.481,
        "text": "really need to think twice before"
      },
      {
        "start": 303.12,
        "duration": 2.72,
        "text": "hitting that command"
      },
      {
        "start": 304.24,
        "duration": 4.239,
        "text": "because what you're doing is you're just"
      },
      {
        "start": 305.84,
        "duration": 5.52,
        "text": "forcing a node out of the cluster"
      },
      {
        "start": 308.479,
        "duration": 4.481,
        "text": "really hard and it may not be the best"
      },
      {
        "start": 311.36,
        "duration": 2.64,
        "text": "situation if you do think you have a"
      },
      {
        "start": 312.96,
        "duration": 2.799,
        "text": "running node in there"
      },
      {
        "start": 314.0,
        "duration": 3.36,
        "text": "it will cause some weird instability if"
      },
      {
        "start": 315.759,
        "duration": 2.241,
        "text": "that data really was supposed to be"
      },
      {
        "start": 317.36,
        "duration": 3.04,
        "text": "there"
      },
      {
        "start": 318.0,
        "duration": 3.44,
        "text": "the command is pretty simple you say no"
      },
      {
        "start": 320.4,
        "duration": 2.72,
        "text": "tool assassinate"
      },
      {
        "start": 321.44,
        "duration": 3.92,
        "text": "put in the ip address of that node you"
      },
      {
        "start": 323.12,
        "duration": 3.84,
        "text": "want to get rid of and it's gone"
      },
      {
        "start": 325.36,
        "duration": 3.52,
        "text": "this has been a pretty good overview of"
      },
      {
        "start": 326.96,
        "duration": 4.0,
        "text": "how to remove nodes in all different"
      },
      {
        "start": 328.88,
        "duration": 4.319,
        "text": "situations from good to bad"
      },
      {
        "start": 330.96,
        "duration": 3.6,
        "text": "and if you have a situation where you"
      },
      {
        "start": 333.199,
        "duration": 5.921,
        "text": "need to remove a node"
      },
      {
        "start": 334.56,
        "duration": 6.639,
        "text": "use one of these techniques"
      },
      {
        "start": 339.12,
        "duration": 2.079,
        "text": "you"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-16T01:34:27.909371+00:00"
}