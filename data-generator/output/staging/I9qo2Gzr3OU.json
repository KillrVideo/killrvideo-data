{
  "video_id": "I9qo2Gzr3OU",
  "title": "DS320.17 Key/Value Pairs: Introduction to Pair RDDs | DataStax Enterprise Analytics",
  "description": "#DataStaxAcademy #DS320\nDS320.17 Key/Value Pairs: Introduction to Pair RDDs\nIn this course, you will learn how to effectively and efficiently solve analytical problems with Apache Spark™, Apache Cassandra™, and DataStax Enterprise. You will learn about the Spark API, Spark-Cassandra Connector, Spark SQL, Spark Streaming, and crucial performance optimization techniques.  You will also learn the basics of the productive and robust Scala programming language for data analysis and processing in Apache Spark™.\n\nLEARN FOR FREE at https://academy.datastax.com -- access all the FREE complete courses, tutorials, and hands-on exercises.\n\nASK QUESTIONS at https://community.datastax.com -- where experts from DataStax & the Apache Cassandra community share their expertise everyday.",
  "published_at": "2020-08-16T00:28:26Z",
  "thumbnail": "https://i.ytimg.com/vi/I9qo2Gzr3OU/maxresdefault.jpg",
  "channel_title": "DataStax Developers",
  "channel_id": "UCAIQY251avaMv7bBv5PCo-A",
  "tags": [
    "cassandra",
    "tutorial",
    "apache_cassandra",
    "introduction",
    "performance",
    "datastax"
  ],
  "url": "https://www.youtube.com/watch?v=I9qo2Gzr3OU",
  "transcript": {
    "available": true,
    "language": "English (auto-generated)",
    "language_code": "en",
    "is_generated": true,
    "text": "[Music] now rdds broadly speaking are collections of data they're divided up into records and the format of those records can vary but a pattern emerges that key value records seem to be especially important they're so important they have some special apis associated with them and we give them their own treatment in this module we're going to dig into some of the operations you can perform on pair rdds and the apis you use them and explore some interesting use cases for pair rdds now in general rdds are collections of records and the stuff inside that record can vary we do find though that key value pair rdds sort of emerge as common pattern so much so that they get their own treatment they're kind of their own thing they're called pair rdds they have their own apis and apply to a few important use cases now the structure of the key the structure of the value those can vary we generally think in trivial examples of the key being a string and the value being an int or something like that but they can be complex and even custom data types we'll take a look in this module at the various apis we use to deal with pair rdds and some of the kinds of problems we can solve with them some of the operations we'll perform on pair rdds will be the things you see here we'll be able to aggregate group and sort in interesting ways we'll be able to do inner and outer joins just like in a relational database with pair rdds and we've got some set operations like union intersection and difference that we'll explore as well now this is not to say that pair rdds don't support the kinds of transformations and actions that we've already covered they absolutely do things like map and filter and collect those are all things we can still do on these we just get a few extra features thrown in let's cover a few obvious examples these are the keys and values transformations if i have a pair rdd which is a collection of key value pairs and i call the keys transformation i'm going to get a new rdd consisting of a collection of just the keys likewise if i call values i'll get a new rdd consisting of just the values of course you might imagine how you could perform those same things using the map transformation that wouldn't be an anti-pattern or anything like that but as a little bit of syntactic sugar keys and values are here for us to use now map values is another thing that we could implement with map but in this case that is considered an anti-pattern if you want to perform a transformation on the values of a pair rdd but leave the keys untouched then you definitely want to use the map values transformation that's going to leave the keys the same this will allow the new rdd to be partitioned in the same way as the old rdd the framework is able to do a little bit of optimization there so if you're trying to map just the values definitely call map values don't use map because that potentially as far as spark is concerned could disturb the partitioning of the rdd and we'd rather not do that if we don't have to now if the values are a collection or if our mapping operation is going to return a collection of things then we can use flat map values that implicitly is going to turn the value that it's mapping from each pair rdd record into some sequence of values and emit it to the destination rdd you can see in this simple example we are mapping the values of that source rdd and just giving everybody a birthday everybody's age is incrementing by one assuming that value is an age there a couple of interesting actions that we can use on pair rdds first there's lookup lookup we're going to give a key and it's going to return to us a sequence of all of the values in the source rdd that have that given key it's as if we're looking up the values in that rdd for that key and that is an action so that's actually going to return that sequence as sort of a result of the computation then we have collect as map now collect we've seen before on rdds collect takes all of the records in the rdd it sort of returns them as a sequence back to the driver program collect as map since this is a pair rdd is going to do that same thing except instead of just a collection it'll be a map and a pair rdd maps onto a map and of course pair rdds translate into maps in a fairly intuitive way so that action makes a lot of sense how might we apply these suppose we wanted to find all the ratings of the movies in our database released in 2014. let's take a look at the code the top couple of lines ought to look fairly familiar at this point we're querying the movies table in the killer video namespace and we're selecting just release year and rating and that's going to give us a tuple we're asking the driver to give us a tuple back containing the release year and the optional float rating then we'll map the values of that pair rdd replacing unrated films with a rating of zero then we'll look up all of the keys that have the value 2014 returning those to the driver iterating over that collection you've got the for each print line to print them out we see the answers are 6.3 6.0 and 5.4 we didn't ask for film names in this example so those are just the ratings we could use this to get an idea of how well film is doing in a particular year and this query would give us that sort of data",
    "segments": [
      {
        "start": 0.06,
        "duration": 3.45,
        "text": "[Music]"
      },
      {
        "start": 6.56,
        "duration": 3.52,
        "text": "now rdds broadly speaking"
      },
      {
        "start": 8.32,
        "duration": 3.439,
        "text": "are collections of data they're divided"
      },
      {
        "start": 10.08,
        "duration": 3.599,
        "text": "up into records and the"
      },
      {
        "start": 11.759,
        "duration": 3.121,
        "text": "format of those records can vary but a"
      },
      {
        "start": 13.679,
        "duration": 3.68,
        "text": "pattern emerges that"
      },
      {
        "start": 14.88,
        "duration": 3.04,
        "text": "key value records seem to be especially"
      },
      {
        "start": 17.359,
        "duration": 1.68,
        "text": "important"
      },
      {
        "start": 17.92,
        "duration": 3.279,
        "text": "they're so important they have some"
      },
      {
        "start": 19.039,
        "duration": 4.0,
        "text": "special apis associated with them"
      },
      {
        "start": 21.199,
        "duration": 3.201,
        "text": "and we give them their own treatment in"
      },
      {
        "start": 23.039,
        "duration": 2.961,
        "text": "this module we're going to dig into some"
      },
      {
        "start": 24.4,
        "duration": 1.92,
        "text": "of the operations you can perform on"
      },
      {
        "start": 26.0,
        "duration": 2.64,
        "text": "pair"
      },
      {
        "start": 26.32,
        "duration": 4.16,
        "text": "rdds and the apis you use them and"
      },
      {
        "start": 28.64,
        "duration": 4.16,
        "text": "explore some interesting use cases for"
      },
      {
        "start": 30.48,
        "duration": 5.2,
        "text": "pair rdds now in general rdds"
      },
      {
        "start": 32.8,
        "duration": 4.72,
        "text": "are collections of records and the stuff"
      },
      {
        "start": 35.68,
        "duration": 4.32,
        "text": "inside that record can vary"
      },
      {
        "start": 37.52,
        "duration": 3.28,
        "text": "we do find though that key value pair"
      },
      {
        "start": 40.0,
        "duration": 3.2,
        "text": "rdds"
      },
      {
        "start": 40.8,
        "duration": 4.079,
        "text": "sort of emerge as common pattern so much"
      },
      {
        "start": 43.2,
        "duration": 2.879,
        "text": "so that they get their own treatment"
      },
      {
        "start": 44.879,
        "duration": 3.441,
        "text": "they're kind of their own thing they're"
      },
      {
        "start": 46.079,
        "duration": 3.121,
        "text": "called pair rdds they have their own"
      },
      {
        "start": 48.32,
        "duration": 4.079,
        "text": "apis"
      },
      {
        "start": 49.2,
        "duration": 4.4,
        "text": "and apply to a few important use cases"
      },
      {
        "start": 52.399,
        "duration": 3.281,
        "text": "now the structure of the key the"
      },
      {
        "start": 53.6,
        "duration": 4.0,
        "text": "structure of the value those can vary"
      },
      {
        "start": 55.68,
        "duration": 3.92,
        "text": "we generally think in trivial examples"
      },
      {
        "start": 57.6,
        "duration": 3.599,
        "text": "of the key being a string and the value"
      },
      {
        "start": 59.6,
        "duration": 3.599,
        "text": "being an int or something like that but"
      },
      {
        "start": 61.199,
        "duration": 2.481,
        "text": "they can be complex and even custom data"
      },
      {
        "start": 63.199,
        "duration": 2.641,
        "text": "types"
      },
      {
        "start": 63.68,
        "duration": 4.0,
        "text": "we'll take a look in this module at the"
      },
      {
        "start": 65.84,
        "duration": 2.56,
        "text": "various apis we use to deal with pair"
      },
      {
        "start": 67.68,
        "duration": 2.4,
        "text": "rdds"
      },
      {
        "start": 68.4,
        "duration": 3.6,
        "text": "and some of the kinds of problems we can"
      },
      {
        "start": 70.08,
        "duration": 3.68,
        "text": "solve with them some of the operations"
      },
      {
        "start": 72.0,
        "duration": 2.72,
        "text": "we'll perform on pair rdds will be the"
      },
      {
        "start": 73.76,
        "duration": 3.039,
        "text": "things you see here"
      },
      {
        "start": 74.72,
        "duration": 3.6,
        "text": "we'll be able to aggregate group and"
      },
      {
        "start": 76.799,
        "duration": 3.121,
        "text": "sort in interesting ways"
      },
      {
        "start": 78.32,
        "duration": 3.439,
        "text": "we'll be able to do inner and outer"
      },
      {
        "start": 79.92,
        "duration": 3.12,
        "text": "joins just like in a relational database"
      },
      {
        "start": 81.759,
        "duration": 2.961,
        "text": "with pair rdds"
      },
      {
        "start": 83.04,
        "duration": 3.28,
        "text": "and we've got some set operations like"
      },
      {
        "start": 84.72,
        "duration": 3.36,
        "text": "union intersection and difference"
      },
      {
        "start": 86.32,
        "duration": 4.24,
        "text": "that we'll explore as well now this is"
      },
      {
        "start": 88.08,
        "duration": 4.399,
        "text": "not to say that pair rdds don't support"
      },
      {
        "start": 90.56,
        "duration": 3.04,
        "text": "the kinds of transformations and actions"
      },
      {
        "start": 92.479,
        "duration": 2.0,
        "text": "that we've already covered they"
      },
      {
        "start": 93.6,
        "duration": 3.44,
        "text": "absolutely do"
      },
      {
        "start": 94.479,
        "duration": 4.241,
        "text": "things like map and filter and collect"
      },
      {
        "start": 97.04,
        "duration": 2.96,
        "text": "those are all things we can still do on"
      },
      {
        "start": 98.72,
        "duration": 3.52,
        "text": "these we just get a few extra"
      },
      {
        "start": 100.0,
        "duration": 3.439,
        "text": "features thrown in let's cover a few"
      },
      {
        "start": 102.24,
        "duration": 3.6,
        "text": "obvious examples"
      },
      {
        "start": 103.439,
        "duration": 4.161,
        "text": "these are the keys and values"
      },
      {
        "start": 105.84,
        "duration": 3.44,
        "text": "transformations if i have a pair"
      },
      {
        "start": 107.6,
        "duration": 3.92,
        "text": "rdd which is a collection of key value"
      },
      {
        "start": 109.28,
        "duration": 3.92,
        "text": "pairs and i call the keys transformation"
      },
      {
        "start": 111.52,
        "duration": 3.599,
        "text": "i'm going to get a new rdd"
      },
      {
        "start": 113.2,
        "duration": 4.16,
        "text": "consisting of a collection of just the"
      },
      {
        "start": 115.119,
        "duration": 3.28,
        "text": "keys likewise if i call values i'll get"
      },
      {
        "start": 117.36,
        "duration": 3.28,
        "text": "a new rdd"
      },
      {
        "start": 118.399,
        "duration": 4.08,
        "text": "consisting of just the values of course"
      },
      {
        "start": 120.64,
        "duration": 3.439,
        "text": "you might imagine how you could perform"
      },
      {
        "start": 122.479,
        "duration": 2.481,
        "text": "those same things using the map"
      },
      {
        "start": 124.079,
        "duration": 2.32,
        "text": "transformation"
      },
      {
        "start": 124.96,
        "duration": 3.04,
        "text": "that wouldn't be an anti-pattern or"
      },
      {
        "start": 126.399,
        "duration": 3.521,
        "text": "anything like that but as"
      },
      {
        "start": 128.0,
        "duration": 3.92,
        "text": "a little bit of syntactic sugar keys and"
      },
      {
        "start": 129.92,
        "duration": 4.48,
        "text": "values are here for us to use"
      },
      {
        "start": 131.92,
        "duration": 4.08,
        "text": "now map values is another thing that we"
      },
      {
        "start": 134.4,
        "duration": 3.6,
        "text": "could implement with map but in this"
      },
      {
        "start": 136.0,
        "duration": 4.0,
        "text": "case that is considered an anti-pattern"
      },
      {
        "start": 138.0,
        "duration": 3.599,
        "text": "if you want to perform a transformation"
      },
      {
        "start": 140.0,
        "duration": 5.12,
        "text": "on the values"
      },
      {
        "start": 141.599,
        "duration": 5.521,
        "text": "of a pair rdd but leave the keys"
      },
      {
        "start": 145.12,
        "duration": 4.479,
        "text": "untouched then you definitely want to"
      },
      {
        "start": 147.12,
        "duration": 4.32,
        "text": "use the map values transformation"
      },
      {
        "start": 149.599,
        "duration": 3.36,
        "text": "that's going to leave the keys the same"
      },
      {
        "start": 151.44,
        "duration": 3.84,
        "text": "this will allow"
      },
      {
        "start": 152.959,
        "duration": 3.36,
        "text": "the new rdd to be partitioned in the"
      },
      {
        "start": 155.28,
        "duration": 3.52,
        "text": "same way"
      },
      {
        "start": 156.319,
        "duration": 4.401,
        "text": "as the old rdd the framework is able to"
      },
      {
        "start": 158.8,
        "duration": 3.439,
        "text": "do a little bit of optimization there"
      },
      {
        "start": 160.72,
        "duration": 3.12,
        "text": "so if you're trying to map just the"
      },
      {
        "start": 162.239,
        "duration": 4.08,
        "text": "values definitely"
      },
      {
        "start": 163.84,
        "duration": 4.08,
        "text": "call map values don't use map because"
      },
      {
        "start": 166.319,
        "duration": 2.241,
        "text": "that potentially as far as spark is"
      },
      {
        "start": 167.92,
        "duration": 3.2,
        "text": "concerned"
      },
      {
        "start": 168.56,
        "duration": 4.16,
        "text": "could disturb the partitioning of the"
      },
      {
        "start": 171.12,
        "duration": 2.72,
        "text": "rdd and we'd rather not do that if we"
      },
      {
        "start": 172.72,
        "duration": 3.76,
        "text": "don't have to"
      },
      {
        "start": 173.84,
        "duration": 5.119,
        "text": "now if the values are a collection or if"
      },
      {
        "start": 176.48,
        "duration": 5.28,
        "text": "our mapping operation is going to return"
      },
      {
        "start": 178.959,
        "duration": 3.521,
        "text": "a collection of things then we can use"
      },
      {
        "start": 181.76,
        "duration": 3.6,
        "text": "flat map"
      },
      {
        "start": 182.48,
        "duration": 3.36,
        "text": "values that implicitly is going to turn"
      },
      {
        "start": 185.36,
        "duration": 2.4,
        "text": "the"
      },
      {
        "start": 185.84,
        "duration": 3.039,
        "text": "value that it's mapping from each pair"
      },
      {
        "start": 187.76,
        "duration": 4.8,
        "text": "rdd record"
      },
      {
        "start": 188.879,
        "duration": 6.801,
        "text": "into some sequence of values and emit it"
      },
      {
        "start": 192.56,
        "duration": 4.319,
        "text": "to the destination rdd you can see in"
      },
      {
        "start": 195.68,
        "duration": 4.24,
        "text": "this simple example"
      },
      {
        "start": 196.879,
        "duration": 3.841,
        "text": "we are mapping the values of that source"
      },
      {
        "start": 199.92,
        "duration": 2.64,
        "text": "rdd"
      },
      {
        "start": 200.72,
        "duration": 4.079,
        "text": "and just giving everybody a birthday"
      },
      {
        "start": 202.56,
        "duration": 4.0,
        "text": "everybody's age is incrementing by one"
      },
      {
        "start": 204.799,
        "duration": 3.52,
        "text": "assuming that value is an age there"
      },
      {
        "start": 206.56,
        "duration": 4.0,
        "text": "a couple of interesting actions that we"
      },
      {
        "start": 208.319,
        "duration": 4.0,
        "text": "can use on pair rdds"
      },
      {
        "start": 210.56,
        "duration": 3.759,
        "text": "first there's lookup lookup we're going"
      },
      {
        "start": 212.319,
        "duration": 2.401,
        "text": "to give a key and it's going to return"
      },
      {
        "start": 214.319,
        "duration": 2.64,
        "text": "to us"
      },
      {
        "start": 214.72,
        "duration": 3.439,
        "text": "a sequence of all of the values in the"
      },
      {
        "start": 216.959,
        "duration": 3.28,
        "text": "source rdd"
      },
      {
        "start": 218.159,
        "duration": 4.16,
        "text": "that have that given key it's as if"
      },
      {
        "start": 220.239,
        "duration": 4.961,
        "text": "we're looking up the values"
      },
      {
        "start": 222.319,
        "duration": 4.241,
        "text": "in that rdd for that key and that is an"
      },
      {
        "start": 225.2,
        "duration": 2.08,
        "text": "action so that's actually going to"
      },
      {
        "start": 226.56,
        "duration": 3.44,
        "text": "return"
      },
      {
        "start": 227.28,
        "duration": 3.519,
        "text": "that sequence as sort of a result of the"
      },
      {
        "start": 230.0,
        "duration": 4.159,
        "text": "computation"
      },
      {
        "start": 230.799,
        "duration": 6.0,
        "text": "then we have collect as map now collect"
      },
      {
        "start": 234.159,
        "duration": 5.201,
        "text": "we've seen before on rdds collect takes"
      },
      {
        "start": 236.799,
        "duration": 4.241,
        "text": "all of the records in the rdd it sort of"
      },
      {
        "start": 239.36,
        "duration": 2.799,
        "text": "returns them as a sequence back to the"
      },
      {
        "start": 241.04,
        "duration": 3.119,
        "text": "driver program"
      },
      {
        "start": 242.159,
        "duration": 3.521,
        "text": "collect as map since this is a pair rdd"
      },
      {
        "start": 244.159,
        "duration": 3.36,
        "text": "is going to do that same thing"
      },
      {
        "start": 245.68,
        "duration": 4.32,
        "text": "except instead of just a collection"
      },
      {
        "start": 247.519,
        "duration": 5.28,
        "text": "it'll be a map and a pair rdd"
      },
      {
        "start": 250.0,
        "duration": 4.319,
        "text": "maps onto a map and of course pair rdds"
      },
      {
        "start": 252.799,
        "duration": 2.401,
        "text": "translate into maps in a fairly"
      },
      {
        "start": 254.319,
        "duration": 3.04,
        "text": "intuitive way"
      },
      {
        "start": 255.2,
        "duration": 3.279,
        "text": "so that action makes a lot of sense how"
      },
      {
        "start": 257.359,
        "duration": 2.4,
        "text": "might we apply these"
      },
      {
        "start": 258.479,
        "duration": 3.28,
        "text": "suppose we wanted to find all the"
      },
      {
        "start": 259.759,
        "duration": 3.761,
        "text": "ratings of the movies in our database"
      },
      {
        "start": 261.759,
        "duration": 3.361,
        "text": "released in 2014."
      },
      {
        "start": 263.52,
        "duration": 3.36,
        "text": "let's take a look at the code the top"
      },
      {
        "start": 265.12,
        "duration": 3.04,
        "text": "couple of lines ought to look fairly"
      },
      {
        "start": 266.88,
        "duration": 3.28,
        "text": "familiar at this point"
      },
      {
        "start": 268.16,
        "duration": 3.52,
        "text": "we're querying the movies table in the"
      },
      {
        "start": 270.16,
        "duration": 3.28,
        "text": "killer video namespace"
      },
      {
        "start": 271.68,
        "duration": 3.2,
        "text": "and we're selecting just release year"
      },
      {
        "start": 273.44,
        "duration": 2.88,
        "text": "and rating"
      },
      {
        "start": 274.88,
        "duration": 3.28,
        "text": "and that's going to give us a tuple"
      },
      {
        "start": 276.32,
        "duration": 2.72,
        "text": "we're asking the driver to give us a"
      },
      {
        "start": 278.16,
        "duration": 2.479,
        "text": "tuple back"
      },
      {
        "start": 279.04,
        "duration": 3.12,
        "text": "containing the release year and the"
      },
      {
        "start": 280.639,
        "duration": 4.881,
        "text": "optional float rating"
      },
      {
        "start": 282.16,
        "duration": 6.4,
        "text": "then we'll map the values of that pair"
      },
      {
        "start": 285.52,
        "duration": 6.0,
        "text": "rdd replacing unrated films"
      },
      {
        "start": 288.56,
        "duration": 4.4,
        "text": "with a rating of zero then we'll look up"
      },
      {
        "start": 291.52,
        "duration": 4.48,
        "text": "all of the keys that"
      },
      {
        "start": 292.96,
        "duration": 3.679,
        "text": "have the value 2014 returning those to"
      },
      {
        "start": 296.0,
        "duration": 2.08,
        "text": "the driver"
      },
      {
        "start": 296.639,
        "duration": 3.041,
        "text": "iterating over that collection you've"
      },
      {
        "start": 298.08,
        "duration": 3.28,
        "text": "got the for each print line"
      },
      {
        "start": 299.68,
        "duration": 4.0,
        "text": "to print them out we see the answers are"
      },
      {
        "start": 301.36,
        "duration": 3.76,
        "text": "6.3 6.0 and 5.4"
      },
      {
        "start": 303.68,
        "duration": 3.519,
        "text": "we didn't ask for film names in this"
      },
      {
        "start": 305.12,
        "duration": 3.84,
        "text": "example so those are just the ratings"
      },
      {
        "start": 307.199,
        "duration": 3.681,
        "text": "we could use this to get an idea of how"
      },
      {
        "start": 308.96,
        "duration": 3.44,
        "text": "well film is doing in a particular year"
      },
      {
        "start": 310.88,
        "duration": 10.4,
        "text": "and this query would give us"
      },
      {
        "start": 312.4,
        "duration": 8.88,
        "text": "that sort of data"
      }
    ],
    "error": null,
    "error_type": null
  },
  "collected_at": "2025-12-15T23:41:33.035745+00:00"
}