# Astra Collections (Data API) Configuration with IBM Granite Embeddings
# Copy this file to config.yaml and fill in your credentials

# Astra Database Configuration
astra:
  # Your Astra API Endpoint
  # Format: https://<database-id>-<region>.apps.astra.datastax.com
  # Get from: Astra Portal → Database → Connect → Data API
  api_endpoint: "https://your-database-id-your-region.apps.astra.datastax.com"

  # Your Astra Token
  # Get from: Astra Portal → Settings → Tokens
  # Requires Database Administrator permissions
  token: "AstraCS:your-token-here"

  # Namespace (keyspace) name
  namespace: "killrvideo"

# Embedding Model Configuration
# Using IBM Granite 30M English model (384 dimensions)
# This model runs locally - no API keys needed!
embedding:
  model_name: "ibm-granite/granite-embedding-30m-english"
  native_dimensions: 384

  # The model will be downloaded automatically on first run (~120MB)
  # Cached in ~/.cache/huggingface/

# Vector Column Mappings for Collections
# Since Collections don't have fixed schemas, we define which fields
# should have embeddings generated
vector_mappings:
  # Videos collection: embed description field
  videos:
    text_field: "description"
    vector_field: "content_vector"  # Will be added to document
    dimensions: 384  # Keep native 384D (no reduction needed for Collections)

  # Tags collection: embed tag name
  tags:
    text_field: "tag"
    vector_field: "tag_vector"
    dimensions: 384

  # User preferences: synthesize from tag preferences
  user_preferences:
    text_field: "_synthesized_preferences"
    vector_field: "preference_vector"
    dimensions: 384

# Data Source
data:
  # Path to CSV files
  csv_dir: "../../data/csv"

# Loading Options
loading:
  # Create collections if they don't exist
  create_collections: true

  # Drop existing collections before loading (CAUTION!)
  drop_existing: false

  # Batch size (Data API has lower limits than CQL)
  batch_size: 20

  # Verbose output
  verbose: true

# Note: We're using client-side embedding generation with IBM Granite
# instead of Astra's Vectorize feature. This gives us:
# - No API key management
# - Consistent embeddings across all platforms
# - Full control over the embedding process
# - Ability to use full 384D vectors (no dimension reduction needed)
